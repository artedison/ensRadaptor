!===================================================
! Reaction Kinetics Ensemble Modeling Code "ens.for"
! Header File "ens.def"
!===================================================
! H.-B. Schuttler
! Department of Physics and Astronomy
! University of Georgia
! Athens, GA 30602
! E-Mail hbs@physast.uga.edu
!
!
! Comment out next line (if active) with "!S" for serial execution:
      use MPI
!
      implicit none
      character*80 VERSION
!

      DATA VERSION/' V. 190527-2227'/
!
!!!   DATA VERSION/' V. 190526-1704'/
!!!   DATA VERSION/' V. 190526-1325'/
!!!   DATA VERSION/' V. 190524-2244'/
!!!   DATA VERSION/' V. 190517-1459'/
!!!   DATA VERSION/' V. 190516-1747'/
!!!   DATA VERSION/' V. 190503-2139'/
!!!   DATA VERSION/' V. 190219-1941'/
!!!   DATA VERSION/' V. 181020-2142'/
!!!   DATA VERSION/' V. 181020-1414'/
!!!   DATA VERSION/' V. 181009-1743'/
!!!   DATA VERSION/' V. 180810-0051'/
!!!   DATA VERSION/' V. 091228-1838'/
!!!   DATA VERSION/' V. 091221-1319'/
!!!   DATA VERSION/' V. 091221-1103'/
!!!   DATA VERSION/' V. 091220-2244'/
!!!   DATA VERSION/' V. 091220-2033'/
!!!   DATA VERSION/' V. 091029-1758'/
!!!   DATA VERSION/' V. 090927-2050'/
!!!   DATA VERSION/' V. 090926-0257'/
!!!   DATA VERSION/' V. 090925-1742'/
!!!   DATA VERSION/' V. 090925-1400'/
!!!   DATA VERSION/' V. 090912-1320'/
!!!   DATA VERSION/' V. 090911-2013'/
!!!   DATA VERSION/' V. 090911-1724'/
!!!   DATA VERSION/' V. 090911-1246'/
!!!   DATA VERSION/' V. 090911-0044'/
!!!   DATA VERSION/' V. 090910-0259'/
!!!   DATA VERSION/' V. 090908-1801'/
!!!   DATA VERSION/' V. 090907-1833'/
!!!   DATA VERSION/' V. 090904-1555'/
!!!   DATA VERSION/' V. 090904-0016'/
!!!   DATA VERSION/' V. 090903-0047'/
!!!   DATA VERSION/' V. 090831-0232'/
!!!   DATA VERSION/' V. 090826-1440'/
!!!   DATA VERSION/' V. 090823-2250'/
!!!   DATA VERSION/' V. 090823-0656'/
!!!   DATA VERSION/' V. 090822-1849'/
!!!   DATA VERSION/' V. 090820-1529'/
!!!   DATA VERSION/' V. 090819-1002'/
!!!   DATA VERSION/' V. 090818-1602'/
!!!   DATA VERSION/' V. 090817-0341'/
!!!   DATA VERSION/' V. 090816-2035'/
!!!   DATA VERSION/' V. 090813-1157'/
!!!   DATA VERSION/' V. 090705-2359'/
!!!   DATA VERSION/' V. 090704-1604'/
!!!   DATA VERSION/' V. 090704-0054'/
!!!   DATA VERSION/' V. 090702-2326'/
!!!   DATA VERSION/' V. 090702-1824'/
!!!   DATA VERSION/' V. 090702-1118'/
!!!   DATA VERSION/' V. 090701-2125'/
!!!   DATA VERSION/' V. 090701-1734'/
!!!   DATA VERSION/' V. 090630-2335'/
!!!   DATA VERSION/' V. 090630-0203'/
!!!   DATA VERSION/' V. 090629-2012'/
!!!   DATA VERSION/' V. 090628-0035'/
!!!   DATA VERSION/' V. 090625-0136'/
!!!   DATA VERSION/' V. 090615-0132'/
!!!   DATA VERSION/' V. 090419-1930'/
!!!   DATA VERSION/' V. 090419-1908'/
!!!   DATA VERSION/' V. 081225-1429'/
!
! Comment out next line (if active) with "!S" for serial execution:
!S    include 'mpif.h'
!
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!     Compilation hints 051214-1530
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! (A) Type declaration of "rand":
! -------------------------------
! On various machines/compilers, you may get error messages
! about the type declaration of "rand". If so, you will need to
! search for and either uncomment, or else comment out, the line
! "real*8 rand" or the line "real*4 rand"  below. If  uncommenting,
! try "real*8 rand" first, then try "real*4 rand". Do not uncomment
! both of these lines!
!
! (B) "ifort" compiler on the "altix.rcc.uga.edu" machine:
! --------------------------------------------------------
! To compile w/ altix "ifort" compiler:
!
! Edit both "ens.for" and "ens.def" (=this file) to make the
! following global changes, on "altix" only:
!   replace the string "itime"  by "itimA" everywhere
!   replace the string "dtime"  by "dtimA" everywhere
!
! (C) Re-serializing the code:
! ----------------------------
! This ens.def file and its corresp. ens.f9* code are
! written for parallel execution invoking the MPI system.
! To convert this code back for serial execution, following
! changes have to be made to remove MPI-specific code
! segments:
! 1) In ens.def:
! --Comment out the statement
!       use mpi
!   and/or the statement
!       include 'mpif.h'
!   whichever may appear anywhere in ens.def
! --Comment out all segments consisting of lines that are
!   enclosed between a pair of special MPI-marker lines
!   of the following format:
!       !MPI_<....
!   and
!       !>MPI_....
!   Here, the marker line beginning with string "!MPI_<"
!   signals the beginning of the MPI-specific code segment;
!   the marker line beginning with string "!>MPI_"
!   signals the end of that MPI-specific code segment.
! 2) In ens.f9*:
! --Comment out all subpgs (subrts and fctns) whose
!   names begin with the string
!       MPI_
! --Comment out all calls to all subrts whose name
!   begins with the string "MPI_", i.e. comment out all
!   subrt call statements beginning with
!       call MPI_
!   and all continuation lines that are part of such a
!   statement. Fortran9* continuation lines are marked
!   by a "&" appearing as the last character at the end
!   of the preceding line. In ens.f9*, all continuation
!   lines will also be marked by having a '&' as the
!   5th character
! --Note: Do _not_ comment out any subpgs or calls/invocations
!   of subpgs whose names begin e.g. with "mp_", "mpm_", or
!   "mps_".
! 3) Important Note on "Commenting Out":
! --In all lines to be commented out in ens.def or ens.f9*
!   the following 2 characters should be _inserted_:
!       !S
!   as the first 2 characters of the line, _without_
!   replacing any characters in the line. (In this manner,
!   easy re-parallelization of the code is preserved).
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!
!MPI_< Begin MPI code segment;
!      comment it out with "!S" for serial execution:
!
      integer                                                           &
     &     mp_status(MPI_STATUS_SIZE)
!
      common /MPI_ia01/                                                 &
     &     mp_status
!
!>MPI_ End MPI code segment
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!     Debug options
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! jdb_i01:
!   =1: write out to screen all text line input from "ens.i01"
!       as it's being read; use to debug input file "ens.i01"
!   =0: don't do "=1"
      integer jdb_i01
      parameter(jdb_i01=1)
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!     array size parameter variables
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
      integer mp_nproc_x, mp_ntag_x, mp_nreq_x                          &
     &   , mp_dim_theta_x, mp_dim_yspec_x, mp_dim_arkabd_x
!
      integer mp_nproc_y, mp_ntag_y, mp_nreq_y                          &
     &   , mp_dim_theta_y, mp_dim_yspec_y, mp_dim_arkabd_y
!
      parameter(mp_nproc_x=200)
      parameter(mp_ntag_x=40)
      parameter(mp_nreq_x=20)
!
      parameter(mp_dim_theta_x=2000)
      parameter(mp_dim_yspec_x=120000)
      parameter(mp_dim_arkabd_x=20000)
!
      integer lblkth_x,kthblk_x,kpmblk_x,lrasf_x                           &
     &  ,ldconr_x,ldconp_x,ldconfz_x,mdconr_x,mdconp_x,mdconfz_x           &
     &  ,kampdv_x,kampdu_x,ntsxdc_x,ntxdc_x
      integer lblkth_y,kthblk_y,kpmblk_y,lrasf_y                           &
     &  ,ldconr_y,ldconp_y,ldconfz_y,mdconr_y,mdconp_y,mdconfz_y           &
     &  ,kampdv_y,kampdu_y,ntsxdc_y,ntxdc_y
!
      parameter(lblkth_x=100)
      parameter(kthblk_x=2000)
      parameter(kpmblk_x=2000)
      parameter(lrasf_x=100)
!
      parameter(ldconr_x=1000)
      parameter(ldconp_x=1000)
      parameter(ldconfz_x=10)
      parameter(mdconr_x=10)
      parameter(mdconp_x=100)
      parameter(mdconfz_x=10)
!
      parameter(kampdv_x=1600)
      parameter(kampdu_x=kampdv_x)
      parameter(ntsxdc_x=1224)
      parameter(ntxdc_x=ntsxdc_x)
!
!
      integer nmc_rep_x,nmc_eql_x,nmc_acc_x,nmc_upd_x,nmove_x           &
     &   ,ntfic_x,ntfic_x1,neintv_x,neintv_x1,ngintv_x,npwgt_x
      integer nmc_rep_y,nmc_eql_y,nmc_acc_y,nmc_upd_y,nmove_y           &
     &   ,ntfic_y,ntfic_y1,neintv_y,neintv_y1,ngintv_y,npwgt_y
!
         parameter(nmc_rep_x=100000)
         parameter(nmc_eql_x=100000)
         parameter(nmc_acc_x=100000)
         parameter(nmc_upd_x=100000)
         parameter(nmove_x=1000000)
         parameter(ntfic_x=100)
         parameter(ntfic_x1=ntfic_x+1)
         parameter(neintv_x=2200)
         parameter(neintv_x1=neintv_x+1)
         parameter(ngintv_x=100)
         parameter(npwgt_x=10)
!
!
      integer jmvloop_n,jmvloop_x,nmvsequ_x
      integer jmvloop_m,jmvloop_y,nmvsequ_y
!
      parameter(jmvloop_n=1)
      parameter(jmvloop_x=2)
      parameter(nmvsequ_x=12)
!
!
      integer njmty_x,ipmty_x, levlp_x
      integer njmty_y,ipmty_y, levlp_y
!
      parameter(njmty_x=12)
      parameter(ipmty_x=3)
      parameter(levlp_x=3)
!
!
      integer nexpt_x,ntxpt_x,nrkit_x,nwintx_x,nbintx_x,mblok_ms_x      &
     &      , ntgri_x, ntifal_x, ntifode_x
      integer nexpt_y,ntxpt_y,nrkit_y,nwintx_y,nbintx_y,mblok_ms_y      &
     &      , ntgri_y, ntifal_y, ntifode_y
!
        parameter(nexpt_x=3)
      parameter(ntxpt_x=400)
!
      parameter(nwintx_x=1)
      parameter(nbintx_x=800)
      parameter(mblok_ms_x=4)
!
!
      integer nspec_x,nreac_x,npart_x,ntime_x,no_time_x,nbx_time_x      &
     &   ,nbaxdi_x,nsegxd_x,nsxdi_x,nms_spec_x,nstp_ark_x               &
     &   ,nsto_ark_x,nsegft_x,nft_time_x,nfil_frq_x,nsft_spec_x         &
     &   ,nsho_frq_x,nspre_x
      integer nspec_y,nreac_y,npart_y,ntime_y,no_time_y,nbx_time_y      &
     &   ,nbaxdi_y,nsegxd_y,nsxdi_y,nms_spec_y,nstp_ark_y               &
     &   ,nsto_ark_y,nsegft_y,nft_time_y,nfil_frq_y,nsft_spec_y         &
     &   ,nsho_frq_y,nspre_y
!
      parameter(nspec_x=60)
      parameter(nms_spec_x=18)
      parameter(nreac_x=32)
      parameter(npart_x=8)
      parameter(ntime_x=800)
      parameter(nstp_ark_x=100000)
      parameter(nsto_ark_x=2)
      parameter(nbx_time_x=200)
!
      integer mrw_lss_x, mreac_lss_x, nnz_lss_x                         &
     &      , lrw_lss_x, liw_lss_x
      integer mrw_lss_y, mreac_lss_y, nnz_lss_y                         &
     &      , lrw_lss_y, liw_lss_y
!
      parameter(mrw_lss_x=2)
      parameter(mreac_lss_x=2)
!
      parameter(nnz_lss_x=nspec_x*npart_x*mreac_lss_x)
!   upper limit:
!     parameter(nnz_lss_x=nspec_x*nspec_x)
!   for nnz_lss:=est. number of non-zero Jacobian matrix
!   elements
!
      parameter(lrw_lss_x=20+(16*nspec_x+3*nnz_lss_x)*mrw_lss_x)
!   recommended by "dlsodes":
!       if(mf_lss.eq. 10)
!    :  lrw_lss_x=20+16*nspec_x*mrw_lss_x
!       if(mf_lss.eq. 22)
!    :  lrw_lss_x=20+(15*nspec_x+3*nnz_lss_x)*mrw_lss_x
!       if(mf_lss.eq.222)
!    :  lrw_lss_x=20+(15*nspec_x+3*nnz_lss_x)*mrw_lss_x
!   where mrw_lss>1 allocates extra work space for sparse matrix
!   routines inside "dlsodes", if needed (mrw_lss=1 should suffice!)
!
      parameter(liw_lss_x=31+nspec_x+nnz_lss_x)
!   recommended by "dlsodes":
!       if(mf_lss.eq. 10) liw_lss_x=30
!       if(mf_lss.eq. 22) liw_lss_x=31+nspec_x+nnz_lss_x
!       if(mf_lss.eq.222) liw_lss_x=30
!
!
! actually using: jo_xspec=2000-->jo_sxt=2
      parameter(no_time_x=(ntime_x+ntxpt_x+1))
!   if jo_sxt=0:
!     output incl. equid. model t-grid and exptl. t-points
!     parameter(no_time_x=(ntime_x+ntxpt_x+1))
!   if jo_sxt=1:
!     suppress equid. model t-grid, output exptl. t-points
!     parameter(no_time_x=ntxpt_x+1)
!   if jo_sxt=2:
!     output equid. model t-grid, suppress exptl. t-points
!     parameter(no_time_x=(ntime_x+1))
!   where jo_sxt is the 1000-digit of input param. jo_xspec:
!     jo_xpec=1000*jo_sxt+100*jo_cfi+10*jo_xdi+1*jo_xko
!
!   example:
!     jo_xspec=2001 --> jo_sxt=2, jo_cfi=0, jo_xdi=0, jo_xko=1
!
!   recommended for large exptl. data sets (ntxpt >> ntime):
!     jo_xspec=2000 --> jo_sxt=2, jo_cfi=0, jo_xdi=0, jo_xko=0
!   with
!     parameter(no_time_x=ntime_x+1)
!
!   recommended for small/medium exptl. data sets
!   (ntxpt ~ ntime):
!     jo_xspec=0000 --> jo_sxt=0, jo_cfi=0, jo_xdi=0, jo_xko=0
!   with
!     parameter(no_time_x=ntime_x+ntxpt_x+1)
!
!
!R    parameter(nbaxdi_x=2)
      parameter(nbaxdi_x=1)
      parameter(nsegxd_x=1)
      parameter(nsegft_x=1)
      parameter(nft_time_x=64)
      parameter(nfil_frq_x=1)
      parameter(nsho_frq_x=5)
      parameter(nsft_spec_x=1)
!
!R    parameter(nsxdi_x=nms_spec_x)
      parameter(nsxdi_x=1)
      parameter(nrkit_x=ntxpt_x+ntime_x)
      parameter(ntgri_x=ntxpt_x+ntime_x)
      parameter(nspre_x=nspec_x+nreac_x)
!
!
      integer npmreac_x,npmspec_x,npmspre_x,mparn_x,ndpen_tot_x     &
     &       ,mdpen_tot_x,msib_dpen_x
      integer npmreac_y,npmspec_y,npmspre_y,mparn_y,ndpen_tot_y     &
     &       ,mdpen_tot_y,msib_dpen_y
!
      parameter(npmspre_x=15)
      parameter(ndpen_tot_x=213)
      ! parameter(mdpen_tot_x=149)
      parameter(mdpen_tot_x=(ndpen_tot_x*nexpt_x))
!
      parameter(mparn_x=153)
      parameter(msib_dpen_x=12)
!!!   parameter(msib_dpen_x=ndpen_tot_x)
!
      parameter(npmspec_x=npmspre_x)
      parameter(npmreac_x=npmspre_x)
!
      parameter(ntifal_x=nspec_x*npmspec_x)
      parameter(ntifode_x=nspec_x*npmspec_x)
!
! Note: Must ALWAYS have:
!       npmspre_x>=max(npmspec_x,npmreac_x)
!
      integer mth_reac_x,mth_spec_x,mth_r_s_x
      integer mth_reac_y,mth_spec_y,mth_r_s_y
!
      integer muf_reac_x,muf_spec_x,muf_r_s_x
      integer muf_reac_y,muf_spec_y,muf_r_s_y
!
!
!DRLIM190524-2244:
      integer muv_reac_x,muv_spec_x,muv_r_s_x,mth_tot_x,mth_swo_x       &
     &       ,mdokin_x, mth_limd_x
      integer muv_reac_y,muv_spec_y,muv_r_s_y,mth_tot_y,mth_swo_y       &
     &       ,mdokin_y, mth_limd_y
!:DRLIM190524-2244
!
!
      parameter(mth_reac_x=(nreac_x*npmreac_x))
      parameter(mth_spec_x=nspec_x*(npmspec_x+1))
!c      parameter(mth_r_s_x=max0(mth_reac_x,mth_spec_x))
      parameter(mth_r_s_x=(mth_reac_x+mth_spec_x))
      parameter(mth_tot_x=(mth_reac_x+mth_spec_x))
      parameter(mdokin_x=(mth_reac_x+mth_spec_x))
      parameter(mth_swo_x=(mth_tot_x+100))
!
!DRLIM190524-2244:
      parameter(mth_limd_x=mth_swo_x)
!:DRLIM190524-2244
!
!
      parameter(muf_reac_x=nreac_x*npmreac_x)
      parameter(muf_spec_x=nspec_x*(npmspec_x+1))
!c      parameter(muf_r_s_x=max0(muf_reac_x,muf_spec_x))
      parameter(muf_r_s_x=(muf_reac_x+muf_spec_x))
!
      parameter(muv_reac_x=nreac_x*npmreac_x)
      parameter(muv_spec_x=nspec_x*(npmspec_x+1))
!c      parameter(muv_r_s_x=max0(muv_reac_x,muv_spec_x))
      parameter(muv_r_s_x=(muv_reac_x+muv_spec_x))
!
!
      integer npopst_x, npopge_x, nthr_x, jtrepl_x, nparst_x            &
     &   , nparge_x
      integer npopst_y, npopge_y, nthr_y, jtrepl_y, nparst_y            &
     &   , nparge_y
!
      parameter(npopst_x=2)
      parameter(npopge_x=npopst_x)
!c      parameter(npopge_x=0)
      parameter(nthr_x=mth_tot_x)
!c      parameter(nthr_x=npopst_x+npopge_x)
!
      parameter(jtrepl_x=3)
      parameter(nparst_x=0)
      parameter(nparge_x=0)
!
!
      integer nvpmreac_x,nvpmspec_x
      integer nvpmreac_y,nvpmspec_y
!
!c      parameter(nvpmreac_x=max0(5,1:nexpt_x))
      parameter(nvpmreac_x=(5+nexpt_x))
!c      parameter(nvpmspec_x=max0(5,1:nexpt_x))
      parameter(nvpmspec_x=(5+nexpt_x))
!
!
      integer ndtin_x,mdtin_x,mdtin_odp_x,niscal_x                      &
     &       ,nipch_x,jfwgt_x
      integer ndtin_y,mdtin_y,mdtin_odp_y,niscal_y                      &
     &       ,nipch_y,jfwgt_y
!
!c    parameter(ndtin_x=nexpt_x*nspec_x*ntxpt_x)
      parameter(ndtin_x=6240)
      parameter(niscal_x=100)
! default:
      parameter(mdtin_x=ndtin_x)
      parameter(mdtin_odp_x=mdtin_x+100)
!
!c    upper limit:
!c    parameter(nipch_x=(ntime_x+1)*niscal_x)
      parameter(nipch_x=(ntime_x+1)*50)
      parameter(jfwgt_x=1)
!
!
      integer npow_reac_x,npow_spec_x
      integer npow_reac_y,npow_spec_y
!
      parameter(npow_reac_x=4)
      parameter(npow_spec_x=npow_reac_x)
!
!
      integer iline_x, norf_x
      integer iline_y, norf_y
!
      parameter(iline_x=200+2*nspec_x+2*nreac_x+5500)
      parameter(norf_x=19)
!
      integer ndig_x
      integer ndig_y
      parameter(ndig_x=200)
!
      integer kosc_hper_x
      integer kosc_hper_y
      parameter(kosc_hper_x=20)
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
      data mp_nproc_y      / mp_nproc_x      /
      data mp_ntag_y       / mp_ntag_x       /
      data mp_nreq_y       / mp_nreq_x       /
      data mp_dim_theta_y  / mp_dim_theta_x  /
      data mp_dim_yspec_y  / mp_dim_yspec_x  /
      data mp_dim_arkabd_y / mp_dim_arkabd_x /
!
      data lblkth_y    / lblkth_x    /
      data kthblk_y    / kthblk_x    /
      data kpmblk_y    / kpmblk_x    /
      data lrasf_y     / lrasf_x     /
      data ldconr_y    / ldconr_x    /
      data ldconp_y    / ldconp_x    /
      data ldconfz_y   / ldconfz_x   /
      data mdconr_y    / mdconr_x    /
      data mdconp_y    / mdconp_x    /
      data mdconfz_y   / mdconfz_x   /
      data kampdv_y    / kampdv_x    /
      data kampdu_y    / kampdu_x    /
      data ntsxdc_y    / ntsxdc_x    /
      data ntxdc_y     / ntxdc_x     /
!
      data nmc_rep_y   / nmc_rep_x   /
      data nmc_eql_y   / nmc_eql_x   /
      data nmc_acc_y   / nmc_acc_x   /
      data nmc_upd_y   / nmc_upd_x   /
      data nmove_y     / nmove_x     /
      data ntfic_y     / ntfic_x     /
      data ntfic_y1    / ntfic_x1    /
      data neintv_y    / neintv_x    /
      data neintv_y1   / neintv_x1   /
      data ngintv_y    / ngintv_x    /
      data npwgt_y     / npwgt_x     /
      data jmvloop_m   / jmvloop_n   /
      data jmvloop_y   / jmvloop_x   /
      data nmvsequ_y   / nmvsequ_x   /
      data njmty_y     / njmty_x     /
      data ipmty_y     / ipmty_x     /
      data levlp_y     / levlp_x     /
      data nexpt_y     / nexpt_x     /
      data ntxpt_y     / ntxpt_x     /
      data nwintx_y    / nwintx_x    /
      data nbintx_y    / nbintx_x    /
      data mblok_ms_y  / mblok_ms_x  /
      data nrkit_y     / nrkit_x     /
      data ntgri_y     / ntgri_x     /
      data nreac_y     / nreac_x     /
      data nspec_y     / nspec_x     /
      data npart_y     / npart_x     /
      data ntime_y     / ntime_x     /
      data nstp_ark_y  / nstp_ark_x  /
      data nsto_ark_y  / nsto_ark_x  /
      data no_time_y   / no_time_x   /
      data nbx_time_y  / nbx_time_x  /
!
      data mrw_lss_y   / mrw_lss_x   /
      data mreac_lss_y / mreac_lss_x /
      data nnz_lss_y   / nnz_lss_x   /
      data lrw_lss_y   / lrw_lss_x   /
      data liw_lss_y   / liw_lss_x   /
!
      data npmreac_y   / npmreac_x   /
      data npmspec_y   / npmspec_x   /
      data ntifal_y    / ntifal_x   /
      data ntifode_y   / ntifode_x   /
      data mth_reac_y  / mth_reac_x  /
      data mth_spec_y  / mth_spec_x  /
      data mth_r_s_y   / mth_r_s_x   /
      data mth_tot_y   / mth_tot_x   /
      data mdokin_y    / mdokin_x    /
      data mth_swo_y   / mth_swo_x   /
!
!DRLIM190524-2244:
      data mth_limd_y   / mth_limd_x   /
!:DRLIM190524-2244
!
      data muf_reac_y  / muf_reac_x  /
      data muf_spec_y  / muf_spec_x  /
      data muf_r_s_y   / muf_r_s_x   /
      data muv_reac_y  / muv_reac_x  /
      data muv_spec_y  / muv_spec_x  /
      data muv_r_s_y   / muv_r_s_x   /
      data npopst_y    / npopst_x    /
      data npopge_y    / npopge_x    /
      data nthr_y      / nthr_x      /
      data jtrepl_y    / jtrepl_x    /
      data nparst_y    / nparst_x    /
      data nvpmreac_y  / nvpmreac_x  /
      data nvpmspec_y  / nvpmspec_x  /
      data ndtin_y     / ndtin_x     /
      data mdtin_y     / mdtin_x     /
      data mdtin_odp_y / mdtin_odp_x /
      data niscal_y    / niscal_x    /
      data nipch_y     / nipch_x     /
      data jfwgt_y     / jfwgt_x     /
      data npow_reac_y / npow_reac_x /
      data npow_spec_y / npow_spec_x /
      data iline_y     / iline_x     /
      data norf_y      / norf_x      /
      data ndig_y      / ndig_x      /
      data nbaxdi_y    / nbaxdi_x    /
      data nsegxd_y    / nsegxd_x    /
      data nsxdi_y     / nsxdi_x     /
      data nms_spec_y  / nms_spec_x  /
      data nsegft_y    / nsegft_x    /
      data nft_time_y  / nft_time_x  /
      data nfil_frq_y  / nfil_frq_x  /
      data nsho_frq_y  / nsho_frq_x  /
      data nsft_spec_y / nsft_spec_x /
      data nspre_y     / nspre_x     /
      data npmspre_y   / npmspre_x   /
      data mparn_y     / mparn_x     /
      data ndpen_tot_y / ndpen_tot_x /
      data mdpen_tot_y / mdpen_tot_x /
      data msib_dpen_y / msib_dpen_x /
      data kosc_hper_y / kosc_hper_x /
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! functions:
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
      logical eqname, gomv
!
      integer  ispre4name, myint
!
!mp_< user mp-functions
      integer  mp_itag, mp_ireq
!>mp_
!
      real*8   randx
!
      real*8   dmin1, dmax1, dcos, dsin, datan, dlog, dexp        &
             , derf, derf_anl, derfc_anl, derfcx_anl
!
      real*8   wtshape, dqbx, xxdi, fspec_ti, dloyy, dexxp    &
     &       , dinvnorm
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! external subprogs.:
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      external sbaxdi
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! common block variables and arrays:
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
!
      logical fexist
!
!mp_< user mp-variables and mp-arrays
      logical lmp_done
!>mp_
!
      character*1  chdum
!
      character*80                                                      &
     &          aline,namespec0,nprfix,vcode,name0,name1,namefunc       &
     &        , funame, fname, fname0, fname1, ename1, ename2           &
     &        , fname_swap0, fname_swap1, errtag, aname, bname          &
     &        , errtag_ck
!
!mp_< user mp-variables and mp-arrays
      character*80                                                      &
     &          namtag, namreq
!>mp
!
      character*80                                                      &
     &         bline(0:iline_x)                                         &
     &       , namespec(1:nspec_x)                                      &
     &       , namereac(1:nreac_x)                                      &
     &       , nameispec(1:npart_x,1:nreac_x)                           &
     &       , nameospec(1:npart_x,1:nreac_x)                           &
     &       , namespec_dtspec(1:nspec_x,1:nexpt_x)                     &
!R   &       , namespec_o(1:(nspec_x+nms_spec_x),1:nexpt_x)             &
     &       , namespec_o(1:1,1:1)                                      &
     &       , namespec_ms_o(1:nms_spec_x)                              &
     &       , namespre(1:nspre_x)                                      &
     &       , namefunc_dpen(1:ndpen_tot_x)                             &
     &       , nmparn(1:mparn_x,1:ndpen_tot_x)                          &
     &       , fname_orf(0:norf_x)                                      &
     &       , sname_orf(0:norf_x)                                      &
     &       , namtag_it(1:2*mp_ntag_x)                                 &
     &       , namreq_ir(1:2*mp_nreq_x)
!
      character*80                                                      &
     &         namespre_lo_blkth(1:lblkth_x)                            &
     &       , namespre_hi_blkth(1:lblkth_x)                            &
     &       , namespre_rasf(1:lrasf_x)                                 &
     &       , name_dconr(1:ldconr_x)                                   &
     &       , name_dconp(1:ldconp_x)                                   &
     &       , namerspec_dconfz(1:ldconfz_x)                            &
     &       , namepspec_dconfz(1:ldconfz_x)
!
      integer                                                           &
     &     jset, nset, iset, nspec, nreac, ispec, ireac, ipart_vs       &
     &   , ntime, ntskip, itime, itime1, mtime, jtime, iun, iline       &
     &   , nmc_rep, nmc_eql, nmc_acc, nmc_upd, jmc_eql, imc_ran         &
     &   , jmvloop, imvsequ, nexpt, jxpt, ntxpt, itxpt, ixpt_ran        &
     &   , jmc_inii, jst_ini, jxref, ipart, ipart1, nwall, nmvth        &
     &   , jo_ar, jo_th, jo_th_xo, jo_xspec, jo_xko, jo_cfi, jo_sxt     &
     &   , jo_th_cu, jo_th_sw, jo_th_wg, jo_th_ft, jo_th_ark            &
     &   , idum1, idum2, ipm, ivpm, npow_spec, npow_reac, jstp_swo0     &
     &   , ith, iuf, iuv, ims, ivs, ith_rk, ith_cs, jrlim, ith_swo      &
     &   , mth_spec, muf_spec, muv_spec, nms_spec, nvs_spec, itag       &
     &   , mth_reac, muf_reac, muv_reac, mit_amb, jbcfic, mpr_swo       &
     &   , mth_tot,  muf_tot,  muv_tot, kmove, jkmove, ivs0, ivs1       &
     &   , itlo, ithi, io_time, no_time, ipart0, nnz_vs, mdtin_odp      &
     &   , ivpm_th, ivpm_uf, ivpm_uv, jinipm_th, iexpt, iout_th         &
     &   , imc_rep, imc_eql, imc_acc, imc_upd, imove, lmvsequ           &
     &   , ith_upd, jprop, jaccp, ipmty, ipow, itfic0, isign_pi         &
     &   , nprop_tot, naccp_tot, ntfic, itfic, ith_ham, ith_half        &
     &   , ispec0, ireac0, ispec_upd, ireac_upd, ipm_upd, lmvgroup      &
     &   , idtin, idtspec, ldtin, ndtin, mdtin, jcl_ham, imc_smp
!
      integer                                                           &
     &     nit_dos, nck_dos, jnm_dos, jck_his, ngintv, igintv           &
     &   , leintv, ieintv, neintv, jcv_dos, jcv_his, mck_dos            &
     &   , ienrg_dos, nacc_dos, it_dos, nei_vis, iout_dos               &
     &   , ien_base, ien_line, nen_inc, ien_inc, iei_min, iei_max       &
     &   , idum, mo_dos, no_dos, jdiv, jbc_dos, icol, ieintv_o          &
     &   , it_dos_o, jaccp_ek, jaccp_ek_up, jprop_ek_up, ixpt_dtin      &
     &   , jmsfic, jdtfic, jfxfic, jct_th, jbc_th, iun0, iun_rst        &
     &   , niscal, iscal, iscal0, iscal1, lpwgt, iout_th_rst            &
     &   , nkscal, kscal, kscal0, jkrxdi_rst, jchi_min, mdtin_raw       &
     &   , jac_swo, jaccp_up, jprop_up, mth_swo, jmc_inir, jmc_ini_rst  &
     &   , kmvsequ, kmvsequ_lp, itxpt_min, itxpt_max, nmc_smp           &
     &   , ktxpt, ktxpt0, ktxpt1, mtxpt, ltxpt0, ntxpt_inp, imc_rep0    &
     &   , jrstart, jmvloop_rst, imc_rep_rst, imc_eql_rst, imc_rep_min  &
     &   , imc_acc_rst, imc_upd_rst, imvsequ_rst, jmty_rst, jo_th_dprec &
     &   , kmove_rst, imove_rst, kmvsequ_rst, imvsequ0, jo_th_mine      &
     &   , ith_rk_rst, ith_cs_rst, itrapz, ntrapz, ioffs, imine         &
     &   , inc_swo, mo_swo, io_swo, itmx, iipch, iipch0, iipch1         &
     &   , jaccp_xst, jprop_xst, jaccp_xst_up, jprop_xst_up             &
     &   , jsig, jipch_nx, nipch, jfwgt, itime0, jprex, kdum
!
      integer                                                           &
     &     meq_fbx, nbx_time, jo_th_opt1, jo_th_opt2, jo_th_hto         &
     &   , jo_th_bxx, jo_th_bxn, jbx_qb0, ibx_time, neq_fbx             &
     &   , jaf, jnf, nac_fbx, mac_fbx, nac_fbxo, nzdig                  &
     &   , mbase, jo_th_mvs, imvsequ_i, imvsequ_f, imvsequ_o            &
     &   , jo_mvsequ, is_xdi, jseg_on, isegxd, itxpt_i, itxpt_f         &
     &   , nbas, nbas1, ndat, jbas, jkrxdi, jsfxdi, jo_xdi              &
     &   , it_xdi, nbas2, ibas, ivsX, jo_abaxdi, jupd_chi               &
     &   , jupd_abaxdi, jupd_sfxdi, isho_frq, nmine_spec                &
     &   , isegft, is_ft, ifil_frq, nsft_spec, nft_htime                &
     &   , ift_time, ift0, ifth, ift_freq, iftp, iftm                   &
     &   , is_ft1, iodd, isig_ft, is_ft_max, nmine_reac                 &
     &   , jbxx_qb_imv, jbxx_af_imv, jbxx_nf_imv, jbxx_mc_imv           &
     &   , jbxn_qb_imv, jbxn_af_imv, jbxn_nf_imv, jbxn_mc_imv           &
     &   , jsft_xd_imv, jsft_pf_imv, jsft_ln_imv, jsft_mc_imv           &
     &   , jsft_wf_imv, nfour_seg, nstp_ark, jsto_ark                   &
     &   , nsto_ark, nfs_spec, nfs_spec0, ifs, k_fai, k_rdo             &
     &   , k_drv, k_oks, k_bad, k_sto, k_slo, k_stp, k_jac              &
     &   , k_rin, irkit, nrkit, itime_i, itime_f, jscal
!
      integer                                                           &
     &     idpen, idpen0, idpen1, ndpen_tot, ndpen_spec                 &
     &   , ndpen_reac, npow_dpen, npmspre0, kdpen                       &
     &   , nspre, ispre, ispre0, ispre1, ispec1, ispec2, ireac1         &
     &   , ipriodp, mparn, iparn, mparnh, ipm0, ipm1, ipm00             &
     &   , jfunc, jwidxpt, mname, iname, jdpenini0                      &
     &   , jrd_th, jrd_swo, kth_spec_gse, kth_reac_gse                  &
     &   , ispecB, ispecX, itime_parn, jfix0, nspre_i, nspre_ia         &
     &   , ispre_D, ispec_D, ireac_D, ipm_D, ims_D                      &
     &   , ispre_P, ispec_P, ireac_P, ipm_P, ims_P                      &
     &   , idpen_P, jctspre_P, ith_P, ispec_M, ispre4                   &
     &   , iparn_i, iparn_f, ipm_i, ipm_f, jcl_rstart                   &
     &   , jskip12, n0skip12, nrskip12, iskip12, nskip12                &
     &   , iwintx, ibintx, iblok, mblok_ms, jcprs_run, jcprs_i          &
     &   , idtspec_run, nwintx_run, idtin_i, idtin_f, nct_avg_tot       &
     &   , idokin, ldokin0, mdokin, mldokin, jckkin             &
     &   , idokin0, iclass, mclass, nclass, ldokin1, ildokin_i          &
     &   , ildokin_f, jpatki, mpatki, jpatkf, ildokin, jdokin_nz
!
      integer                                                           &
     &     ljmty, levlp, levlp_nxt, levlp0, kmvsequ_ini                 &
     &   , imvsequ_fst, imvsequ_lst, imvsequ_prv, imvsequ_nxt           &
     &   , iorf, iorf0, iorf1, iorf2, iorfx, iout0, iout1, ioutx        &
     &   , jpst_sch, jinist, jxc1st, jxc2st, jmthyst, jrthyst           &
     &   , mthyst, nparst, npopst, npopst_lst, npopst_sin, ireyst       &
     &   , ipop, ipop_upd, ipop_xch, ipop_pst, jxthyst                  &
     &   , jtrepl, jtrepl0, jtrepl1, kthr, jtmpst, jtmpst_lst           &
     &   , iun_orf, ilev, morf, norf_max, mfoxst, ifoxst                &
     &   , iout_th_rsi, imvsequ_rsi, kmvsequ_rsi, jmvloop_rsi           &
     &   , imc_rep_rsi, imc_eql_rsi, imc_acc_rsi, imc_upd_rsi           &
     &   , jmty_rsi, imove_rsi, jamb_rsi, jpst_rsi, jpge_rsi            &
     &   , jamb_ini, jamb_repl, ipop_pge, ipop_xst, ipop_yst            &
     &   , ipop_xge, kthr_upd, kthr_xch, kmove_rsi, idtspec1            &
     &   , k_fxcount, k_fxh, k_fxo
!
      integer                                                           &
     &     jidat_amb, mhtot_amb, ihtot_amb, imove_amb, jo_amb           &
     &   , ihtot_amb_ini, ihtot_amb_rst, ict_ham                        &
     &   , jidat_pst, mhtot_pst, ihtot_pst, imove_pst, jo_pst           &
     &   , ihtot_pst_ini, ihtot_pst_rst                                 &
     &   , jidat_pge, mhtot_pge, ihtot_pge, imove_pge, jo_pge           &
     &   , ihtot_pge_ini, ihtot_pge_rst                                 &
     &   , npopge, kxst, ixst, ihupd, ihupd_skip, mth_xch               &
     &   , kthyst, kthyst0, ixge, lhtot_pst, lhtot_ham                  &
     &   , inc_pst0, inc_pst1, inc_yst, inc_ham, inc_amb                &
     &   , jck_thr, jdo_st4ge, jinige, jtmpge, jfsuge, jbsuge           &
     &   , jrsuge, jxsuge, jysuge, jnsuge, nparge                       &
     &   , ipop_fsu, ipop_fsu1, ipop_fsu2, ipop_blo, nsurvge            &
     &   , isurv, ipop_ancs, ipop_rsu, ipop_swp, npopge_lst             &
     &   , npopge_sin, ipop_fsux, isurvx, ipop_ancs0                    &
     &   , nsurvck1, nsurvck2, jpge_sch, ipop1, ipop2
!
      integer                                                           &
     &     jclC, jclO, ido_lss, jfail_lss, itol_lss, itask_lss          &
     &   , istate_lss, iopt_lss, lrw_lss, liw_lss, nnz_lss              &
     &   , mf_lss, mf_lssr, mflag_lss, jtime_ark, jtime_abd             &
     &   , itgri, ntgri, mshift, ipulse, itifal, itif                   &
     &   , ntifal_ini, ntifal_fin, itifode, ntifode, jtifode            &
     &   , ntifode_prv, npwgt_tot, iexpt0, iexpt1, ims0, ims1           &
     &   , itxpt0, itxpt1, ipwgt, jrand, iseed2, lcrdp                  &
     &   , jwwgt_run, mdpen_tot, mdpen_spec, mdpen_reac, lcrdp0         &
     &   , ierrtag, jerrtag, iexpt_bgun, iexpt_pak, iexpt_upk           &
     &   , istat_ofile, istat_rc, jmp_stat_procs, jmp_comid
!
      integer                                                           &
     &     jgmult, isib, ispec_drdp, jtime_drdp, ipriodp1, itimep       &
     &   , icplex                                                       &
!V091218:
     &   , jfol_opt1, jfol_opt2, nintfol                                &
     &   , nagene, nbgene, npprod, nqdegr, igene, iintfol
!:V091218
!
      integer                                                           &
     &     josc_dbase, josc_find, josc_twlo, josc_twhi, josc_tper       &
     &   , josc_tdamp, josc_tdamp0, josc_tdamp1, josc_phas, josc_ampl   &
     &   , josc_udamp, josc_xtr0, kosc_hper, kosc_xtr, kosc             &
     &   , kosc_ini, kosc_fin, itosc, itosc_wlo, itosc_whi, ispec_osc   &
     &   , jsto_itsib, jfunc_sibn, jfunc_sibx, jfunc0                   &
     &   , idpfour, ndpfour, idpenS, jtavg_xsib, iparn_min, iparn_max
!
      integer                                                           &
     &     ktsxdc, jmty_ij, lblkth, ldconr, ldconp                      &
     &   , ldconfz, mtsxdc_max, iblkth, mthblk0, mthblk1                &
     &   , idcon, lblkth_tot, ldconr_tot, ldconp_tot, ldconfz_tot       &
     &   , kthblk, kthblk_tot, lblkth_i, lblkth_f, kthblk_i, kthblk_f   &
     &   , kthblk0, kthblk1, mdcon_rpspec, kth_upd                      &
     &   , kpmblk, kpmblk0, kpmblk_tot, kampdv, kampdu                  &
     &   , kampdv1, kampdv2, iampdu1, iampdu2, idconr1, idconr2, idconr &
     &   , kampdv_tot, kampdu_tot, ipspec, irspec, ldconr1              &
     &   , ldconr2, itsxdc, itsxdc0, itsxdc1, itsxdc2, ntsxdc_tot       &
     &   , itxdc, ntxdc, ntxdc0, ipm2, jerrivn, jerrtg                  &
     &   , jmsip, irspec1, irspec2, ith2, ispre2, iampdu_upd            &
     &   , idcsweep, idcsweep_tot, ith_ampdv, ithc, ithc0, lrasf, irasf &
     &   , jrasf_ctl_ij, jrasf_fmt_ij, jrasf_xch_ij, jrasf_ctl_log      &
     &   , jrasf_ctl_lin, jrasf_freez, jsto_chiras, jinfin_rasf         &
     &   , lrasf_tot, jpoiss, jclev, jDB_sum_chi, jDB_get_chi           &
     &   , jDB_chi_accu                                                 &
     &   , jevphi, jerr_evphi, ievphi, ievphi0, ievphi_upd, iampdu      &
     &   , jzeta_bound, mratf, nratf
!
!DRLIM190524-2244:
      integer                                                           &
     &     iexpt_drv, ith_limd, ith_cs_limd, ith_rk_limd                &
     &   , jlimd, jo_th_lmdrv, jo_th_mchi                               &
     &   , mlimdrv, mlimdrv_tot, mth_limd, njlimd_tot, nmlimd_tot       &
     &   , nplimd_tot, nlim_drv, nlim_drv0, nlim_all, n_drv
!:DRLIM190524-2244
!
!
!mp_< user mp-variables and mp-arrays
      integer                                                           &
     &     mp_nproc, mp_ntag, mp_nreq, mp_ierr, mp_iproc                &
     &   , mp_myid, mp_mrid, mp_svid, mp_qiniid, mp_qfinid              &
     &   , mp_errcode, mp_ipak, mp_dim_theta, mp_dim_arkabd             &
     &   , mp_dim_yspec_inc1, mp_dim_yspec_inc2, mp_dim_yspec_inc4      &
     &   , mp_dim_yspec_inc0                                            &
     &   , mp_mexpt_done, mp_mexpt_dokin, mp_mproc_busy, mp_tag_ub      &
     &   , jmp_task, jmp_kin, jmp_kin0, iun39, mp_w2sv, ireq, mp_isid   &
     &   , kreq
!>mp_
!
      integer                                                           &
     &     iispec(1:npart_x,1:nreac_x)                                  &
     &   , iospec(1:npart_x,1:nreac_x)                                  &
     &   , mispec(1:npart_x,1:nreac_x)                                  &
     &   , mospec(1:npart_x,1:nreac_x)                                  &
     &   , nipart(1:nreac_x)                                            &
     &   , nopart(1:nreac_x)                                            &
     &   , iivs_vs(1:npart_x,1:nreac_x)                                 &
     &   , iovs_vs(1:npart_x,1:nreac_x)                                 &
     &   , iispec_vs(1:npart_x,1:nreac_x)                               &
     &   , iospec_vs(1:npart_x,1:nreac_x)                               &
     &   , mispec_vs(1:npart_x,1:nreac_x)                               &
     &   , mospec_vs(1:npart_x,1:nreac_x)                               &
     &   , nipart_vs(1:nreac_x)                                         &
     &   , nopart_vs(1:nreac_x)                                         &
     &   , nireac_vs(1:nspec_x)                                         &
     &   , noreac_vs(1:nspec_x)                                         &
     &   , jkin(1:nreac_x)
!
      integer                                                           &
     &     jfix(1:nspec_x)                                              &
     &   , jfox(1:nspec_x)                                              &
     &   , npulse(1:nspec_x)                                            &
     &   , mpulse(1:nspec_x)                                            &
     &   , nperiod(1:nspec_x)                                           &
     &   , mth_ty(1:ipmty_x)                                            &
     &   , itime_xpt(1:ntxpt_x)                                         &
     &   , ltxpt_kt(1:ntxpt_x)                                          &
     &   , itxpt_kt(1:ntxpt_x)                                          &
     &   , mdtin_tx(1:ntxpt_x)                                          &
     &   , mdtin_ms(1:nms_spec_x)                                       &
     &   , mdtin_xp(1:nexpt_x)                                          &
     &   , mdtin_msxp(1:nms_spec_x,1:nexpt_x)                           &
     &   , jmvsched(jmvloop_n:jmvloop_x)                                &
     &   , jrpwgt(jmvloop_n:jmvloop_x)                                  &
     &   , nmvsequ(jmvloop_n:jmvloop_x)                                 &
     &   , jiline(0:iline_x)
!
      integer                                                           &
     &     jmty(1:nmvsequ_x,jmvloop_n:jmvloop_x)                        &
     &   , jnorep(1:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , jmty_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , nmove(1:nmvsequ_x,jmvloop_n:jmvloop_x)                       &
     &   , jtmp_mv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_en(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_kx(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_sx(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jstp_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , kmvsequ_mvs(-1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     jwgt_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jwgt_mv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jwgt_tv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jwgt_sh(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jwgt_wc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , npwgt(0:1,1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , iexpt_wc0(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)         &
     &   , iexpt_wc1(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)         &
     &   , ims_wc0(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)           &
     &   , ims_wc1(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)           &
     &   , itxpt_wc0(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)         &
     &   , itxpt_wc1(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     nprop(0:mth_r_s_x,1:nmvsequ_x                                &
     &          ,jmvloop_n:jmvloop_x,1:ipmty_x)                         &
     &   , naccp(0:mth_r_s_x,1:nmvsequ_x                                &
     &          ,jmvloop_n:jmvloop_x,1:ipmty_x)                         &
     &   , nprop_ty(0:mth_r_s_x,1:njmty_x                               &
     &             ,jmvloop_n:jmvloop_x,1:ipmty_x)                      &
     &   , naccp_ty(0:mth_r_s_x,1:njmty_x                               &
     &             ,jmvloop_n:jmvloop_x,1:ipmty_x)                      &
     &   , nprop_spec(0:mth_spec_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , naccp_spec(0:mth_spec_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , nprop_reac(0:mth_reac_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , naccp_reac(0:mth_reac_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , nkin_run(jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     jout_swo(1:mth_swo_x)                                        &
     &   , jstp_swo(1:mth_swo_x)                                        &
     &   , naccp_swo(1:mth_swo_x)                                       &
     &   , naccp_up_swo(1:mth_swo_x)                                    &
     &   , nprop_swo(1:mth_swo_x)                                       &
     &   , nprop_up_swo(1:mth_swo_x)
!
      integer                                                           &
     &     npmspec(1:nspec_x)                                           &
     &   , jmsspec(1:nspec_x)                                           &
     &   , ims_spec(1:nspec_x)                                          &
     &   , ispec_ms(1:nspec_x)                                          &
     &   , ispec_fs(1:(nspec_x+nms_spec_x))                             &
     &   , ispec_vs(1:(nspec_x+nms_spec_x))                             &
     &   , ifs_spec(1:(nspec_x+nms_spec_x))                             &
     &   , ivs_spec(1:(nspec_x+nms_spec_x))                             &
     &   , jnz_vs(1:(nspec_x+nms_spec_x))                               &
     &   , lspec_max(1:nspec_x)                                         &
     &   , lspec_min(1:nspec_x)                                         &
     &   , lvfor(1:nreac_x)                                             &
     &   , lvbak(1:nreac_x)                                             &
     &   , lvreac(1:nreac_x)                                            &
     &   , npmreac(1:nreac_x)                                           &
     &   , k_hlo(1:2)                                                   &
     &   , k_ist(1:7)                                                   &
     &   , neq_lss(1:2)                                                 &
     &   , iwork_lss(1:liw_lss_x)
!
      integer                                                           &
     &     ndtspec(1:nexpt_x)                                           &
     &   , ntxpt_dtspec(1:nspec_x,1:nexpt_x)                            &
     &   , iexpt_dtin(1:ndtin_x)                                        &
     &   , ispec_dtin(1:ndtin_x)                                        &
     &   , itxpt_dtin(1:ndtin_x)                                        &
     &   , jzwid(1:ndtin_x)                                             &
     &   , lscal(1:ndtin_x)                                             &
     &   , jzproc(1:ndtin_x)                                            &
!
!R   &   , jbaxdi_dtin(1:ndtin_x)                                       &
     &   , jbaxdi_dtin(1:1)                                             &
!R   &   , nbaxdi_dtin(1:ndtin_x)                                       &
     &   , nbaxdi_dtin(1:1)                                             &
!R   &   , jzxdi_dtin(1:ndtin_x)                                        &
     &   , jzxdi_dtin(1:1)                                              &
!
     &   , idtin_sxi(1:nspec_x,1:nexpt_x)                               &
     &   , idtin_sxf(1:nspec_x,1:nexpt_x)
!
      integer                                                           &
     &     lscal_is(1:niscal_x)                                         &
     &   , lscal_is1(1:niscal_x)                                        &
     &   , lscal_xpt(0:mdtin_odp_x)                                     &
     &   , iscal_xpt(0:mdtin_odp_x)                                     &
     &   , kscal_xpt(0:mdtin_x)                                         &
     &   , kscal_is(1:niscal_x)                                         &
     &   , mscal_is(1:niscal_x)                                         &
     &   , mscal_ks(1:niscal_x)                                         &
     &   , jcprs_dtspec(1:nspec_x,1:nexpt_x)                            &
     &   , nwintx(1:nspec_x,1:nexpt_x)                                  &
     &   , nbintx(1:nwintx_x,1:nspec_x,1:nexpt_x)                       &
     &   , jcprs_win(1:nwintx_x,1:nspec_x,1:nexpt_x)                    &
     &   , idtin_avg(1:nbintx_x)                                        &
     &   , lscal_avg(1:nbintx_x)                                        &
     &   , nct_avg(1:nbintx_x)                                          &
     &   , idtspec_blok(1:mblok_ms_x)
!
      integer                                                           &
     &     jctspec(1:nspec_x,0:npmspec_x)                               &
     &   , jbcspec(1:nspec_x,0:npmspec_x)                               &
     &   , nvpmspec(1:nspec_x,0:npmspec_x)                              &
     &   , ispec_th(1:mth_spec_x)                                       &
     &   , ispec_uf(1:muf_spec_x)                                       &
     &   , ispec_uv(1:muv_spec_x)                                       &
     &   , ipmspec_th(1:mth_spec_x)                                     &
     &   , ipmspec_uf(1:muf_spec_x)                                     &
     &   , ipmspec_uv(1:muv_spec_x)                                     &
     &   , itime_o(1:no_time_x)                                         &
     &   , itxpt_o(1:no_time_x)
!
      integer                                                           &
     &     jctreac(1:nreac_x,1:npmreac_x)                               &
     &   , jbcreac(1:nreac_x,1:npmreac_x)                               &
     &   , nvpmreac(1:nreac_x,1:npmreac_x)                              &
     &   , ireac_th(1:mth_reac_x)                                       &
     &   , ireac_uf(1:muf_reac_x)                                       &
     &   , ireac_uv(1:muv_reac_x)                                       &
     &   , ipmreac_th(1:mth_reac_x)                                     &
     &   , ipmreac_uf(1:muf_reac_x)                                     &
     &   , ipmreac_uv(1:muv_reac_x)
!
      integer                                                           &
     &     nprop_ham_ini(jmvloop_n:jmvloop_x)                           &
     &   , nprop_ham_fin(jmvloop_n:jmvloop_x)                           &
     &   , naccp_ham_fin(jmvloop_n:jmvloop_x)                           &
     &   , nprop_ham(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , naccp_ham(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jct_ham(1:mth_tot_x)                                         &
     &   , mgintv(0:ngintv_x)                                           &
     &   , jdv_ig(0:ngintv_x)                                           &
     &   , jei_vis(0:neintv_x1)
!
      integer                                                           &
     &     jbxx_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxx_mv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxx_nf(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxx_af(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxx_qb(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxn_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxn_mv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxn_nf(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxn_af(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbxn_qb(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , itime_bx(1:nbx_time_x)                                       &
     &   , jdig(1:ndig_x)
!
      integer                                                           &
!R   &     jbaxdi_xpt(0:mdtin_x)                                        &
     &     jbaxdi_xpt(0:1)                                              &
!R   &   , jzxdi_xpt(0:mdtin_x)                                         &
     &   , jzxdi_xpt(0:1)                                               &
!R   &   , nbaxdi_xpt(0:mdtin_x)                                        &
     &   , nbaxdi_xpt(0:1)                                              &
!R   &   , is_xdi_spec(1:(nspec_x+nms_spec_x),1:nexpt_x)                &
     &   , is_xdi_spec(1:1,1:1)                                         &
!R   &   , is_xdi_vs(1:(nspec_x+nms_spec_x),1:nexpt_x)                  &
     &   , is_xdi_vs(1:1,1:1)                                           &
!R   &   , ispec_xdi(1:nms_spec_x,1:nexpt_x)                            &
     &   , ispec_xdi(1:1,1:1)                                           &
!R   &   , ispecX_spec(1:nspec_x,1:nexpt_x)                             &
     &   , ispecX_spec(1:1,1:1)                                         &
!R   &   , ispecX_xdi(1:nms_spec_x,1:nexpt_x)                           &
     &   , ispecX_xdi(1:1,1:1)                                          &
!R   &   , ispecX_vs(1:nspec_x,1:nexpt_x)
     &   , ispecX_vs(1:1,1:1)
!
      integer                                                           &
!R   &     itxpt_xdii(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                &
     &     itxpt_xdii(1:1,1:1,1:1)                                      &
!R   &   , itxpt_xdif(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                &
     &   , itxpt_xdif(1:1,1:1,1:1)                                      &
!R   &   , itime_xdii(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                &
     &   , itime_xdii(1:1,1:1,1:1)                                      &
!R   &   , itime_xdif(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                &
     &   , itime_xdif(1:1,1:1,1:1)                                      &
!R   &   , jbaxdi(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                    &
     &   , jbaxdi(1:1,1:1,1:1)                                          &
!R   &   , ntxdi(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                     &
     &   , ntxdi(1:1,1:1,1:1)                                           &
!R   &   , nbaxdi(0:1,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                &
     &   , nbaxdi(0:1,1:1,1:1,1:1)                                      &
!R   &   , nsegxd(1:nms_spec_x,1:nexpt_x)                               &
     &   , nsegxd(1:1,1:1)                                              &
!R   &   , jsegxd(1:nspec_x,0:ntime_x)                                  &
     &   , jsegxd(1:1,1:1)                                              &
!
     &   , nsxdi_spec(1:nexpt_x)                                        &
     &   , nspec_o(1:nexpt_x)
!c   1   , nvs_spec_o(1:nexpt_x)
!
      integer                                                           &
!R   &     jsft_xd(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &     jsft_xd(1:1,1:1)                                             &
     &   , jsft_wf(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jsft_pf(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jsft_ln(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jsft_mv(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jsft_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , itime_ft(0:nft_time_x,1:nsegft_x,1:nexpt_x)                  &
     &   , ift_freq_fil(1:nfil_frq_x,1:nsegft_x,1:nexpt_x)              &
     &   , ift_freq_sho(1:nsho_frq_x,1:nsegft_x,1:nexpt_x)              &
!R   &   , isegxd_sft(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)               &
     &   , isegxd_sft(1:1,1:1,1:1)                                      &
     &   , lft_time(1:nsegft_x,1:nexpt_x)                               &
     &   , nft_time(1:nsegft_x,1:nexpt_x)                               &
     &   , nfil_frq(1:nsegft_x,1:nexpt_x)                               &
     &   , nsho_frq(1:nsegft_x,1:nexpt_x)                               &
     &   , jfil_frq(1:nsegft_x,1:nexpt_x)
!
      integer                                                           &
     &     nsegft(1:nexpt_x)                                            &
     &   , ispec_sft(1:nsft_spec_x)                                     &
     &   , is_ft_spec(1:nspec_x)                                        &
     &   , jmsspec_ft(1:nspec_x)                                        &
     &   , jmsspec_px(1:nspec_x)                                        &
     &   , jmsspec_ip(1:nspec_x)                                        &
     &   , jmsspec_ch(1:nspec_x)                                        &
     &   , jrkit_xpt(1:ntxpt_x)                                         &
     &   , itime_rki(0:nrkit_x)                                         &
     &   , itxpt_rki(0:nrkit_x)                                         &
!
     &   , jtgri_xpt(1:ntxpt_x)                                         &
     &   , itime_tgr(0:ntgri_x)                                         &
     &   , itxpt_tgr(0:ntgri_x)                                         &
     &   , jfin_tif_fs(1:(nspec_x+nms_spec_x))                          &
     &   , ipulse_tif_fs(1:(nspec_x+nms_spec_x))                        &
     &   , mshift_tif_fs(1:(nspec_x+nms_spec_x))
!
      integer                                                           &
     &     jpmspec(1:nspec_x)                                           &
     &   , npxspec(1:nspec_x)                                           &
     &   , jpmreac(1:nreac_x)                                           &
     &   , npxreac(1:nreac_x)                                           &
     &   , npmspre(1:nspre_x)                                           &
     &   , kdpen_spre(0:nspre_x)                                        &
     &   , ispre_nam(1:nspre_x)                                         &
     &   , idpen_spre(1:nspre_x,1:npmspre_x)                            &
     &   , jctspre(1:nspre_x,1:npmspre_x)                               &
     &   , jbcspre(1:nspre_x,1:npmspre_x)                               &
     &   , ith_spre(1:nspre_x,1:npmspre_x)                              &
     &   , jdpenini(1:nspre_x,1:npmspre_x)                              &
     &   , idpen_prio(1:ndpen_tot_x)
!
      integer                                                           &
     &     ispre_dpen(1:ndpen_tot_x)                                    &
     &   , ispec_dpen(1:ndpen_tot_x)                                    &
     &   , ireac_dpen(1:ndpen_tot_x)                                    &
     &   , ipm_dpen(1:ndpen_tot_x)                                      &
     &   , mparn_dpen(1:ndpen_tot_x)                                    &
     &   , jprio_dpen(1:ndpen_tot_x)                                    &
     &   , jfunc_dpen(1:ndpen_tot_x)                                    &
     &   , ipm_parn(1:mparn_x,1:ndpen_tot_x)                            &
     &   , iti_parn(1:mparn_x,1:ndpen_tot_x)                            &
     &   , ispec_parn(1:mparn_x,1:ndpen_tot_x)                          &
     &   , ireac_parn(1:mparn_x,1:ndpen_tot_x)                          &
     &   , ispre_parn(1:mparn_x,1:ndpen_tot_x)
!
      integer                                                           &
     &     jini_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jxc1_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jxc2_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jmthy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , jrthy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , jxthy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , mfox_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , npar_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , npop_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , ljmty_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jmty_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , levlp_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , nmovr_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     imvsequ_fst_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)             &
     &   , imvsequ_lst_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)             &
     &   , imvsequ_prv_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)             &
     &   , imvsequ_nxt_mvs(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     iout_tr_orf(0:norf_x)                                        &
     &   , iout_th_orf(0:norf_x)                                        &
     &   , kmvsequ_orf(0:norf_x)                                        &
     &   , jmvloop_orf(0:norf_x)                                        &
     &   , imove_orf(0:norf_x)                                          &
     &   , imvsequ_orf(0:norf_x)                                        &
     &   , jnew_orf(0:norf_x)                                           &
     &   , imc_rep_orf(0:norf_x)                                        &
     &   , imc_eql_orf(0:norf_x)                                        &
     &   , imc_acc_orf(0:norf_x)                                        &
     &   , imc_upd_orf(0:norf_x)                                        &
     &   , jmty_orf(0:norf_x)                                           &
     &   , nthr_orf(0:norf_x)                                           &
     &   , jtrepl_orf(0:norf_x)                                         &
     &   , jorf(0:norf_x)                                               &
     &   , iorf_new(0:norf_x,1:jtrepl_x)                                &
     &   , iorf_old(0:norf_x,1:jtrepl_x)                                &
     &   , iorf_max(1:jtrepl_x)
!
      integer                                                           &
     &     imovr_mvs(1:nmvsequ_x)                                       &
     &   , njmty(jmvloop_n:jmvloop_x)                                   &
     &   , jmty_lj(1:njmty_x,jmvloop_n:jmvloop_x)                       &
     &   , iout_repl(1:jtrepl_x)                                        &
     &   , nthr_repl(1:jtrepl_x)                                        &
     &   , iorf_repl(1:jtrepl_x)                                        &
     &   , ith_xch(1:mth_tot_x)                                         &
     &   , imvsequ_lev(0:levlp_x)                                       &
     &   , imvsequ_fst_lev(0:levlp_x)                                   &
     &   , imvsequ_lst_lev(0:levlp_x)                                   &
     &   , imvsequ_prv_lev(0:levlp_x)                                   &
     &   , imvsequ_nxt_lev(0:levlp_x)                                   &
     &   , iorst(0:npopst_x)                                            &
     &   , nprop_pop(0:npopst_x)                                        &
     &   , nprop_up_pop(0:npopst_x)                                     &
     &   , naccp_pop(0:npopst_x)                                        &
     &   , naccp_up_pop(0:npopst_x)                                     &
     &   , jstp_pop(0:npopst_x)
!
      integer                                                           &
     &     ipop_y(1:2)                                                  &
     &   , jini_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jtmp_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jfsu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jnsu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jbsu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jrsu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jxsu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , jysu_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , npar_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , npop_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , iorge(0:npopge_x)                                            &
     &   , jsurv(0:npopge_x)                                            &
     &   , isurv_pop(0:npopge_x)                                        &
     &   , ipop_surv(0:npopge_x)                                        &
     &   , jhoodst(0:npopge_x)
!
      integer                                                           &
     &     iorge9(0:npopge_x)                                           &
     &   , jsurv9(0:npopge_x)                                           &
     &   , isurv9_pop(0:npopge_x)                                       &
     &   , ipop9_surv(0:npopge_x)                                       &
     &   , ipop_orge(0:npopge_x)
!
      integer                                                           &
     &     itmx_xpt(1:nms_spec_x,1:ntxpt_x,1:nexpt_x)                   &
     &   , itmx_ini(1:nms_spec_x,1:nexpt_x)                             &
     &   , itmx_fin(1:nms_spec_x,1:nexpt_x)                             &
     &   , itmx_ini_odp(1:nms_spec_x,1:nexpt_x)                         &
     &   , itmx_fin_odp(1:nms_spec_x,1:nexpt_x)                         &
     &   , iipch_ini(1:nms_spec_x,1:nexpt_x)                            &
     &   , iipch_fin(1:nms_spec_x,1:nexpt_x)                            &
     &   , ims_PD(1:nms_spec_x)                                         &
     &   , iipch_tmx(0:mdtin_x)                                         &
     &   , itxpt_tmx(0:mdtin_x)                                         &
     &   , kscal_ipch(0:nipch_x)                                        &
     &   , iscal_ipch(0:nipch_x)                                        &
     &   , itime_ipch(0:nipch_x)
!
      integer                                                           &
     &     ldokin(1:mdokin_x)                                           &
     &   , ireac_dokin(1:mdokin_x)                                      &
     &   , ispec_dokin(1:mdokin_x)                                      &
     &   , ipm_dokin(1:mdokin_x)                                        &
     &   , jdokin(1:nexpt_x)                            &
     &   , jdokin_expt(1:nexpt_x,1:mdokin_x)                            &
     &   , jdokin_expt0(1:nexpt_x)                                      &
     &   , jdokin_expt1(1:nexpt_x)                                      &
     &   , idokin_spre(1:nspre_x,0:npmspre_x)                           &
     &   , ldokin_inp(1:mdokin_x)                                       &
     &   , idokin_inp(1:mdokin_x)                                       &
     &   , iline_dokin(1:2,1:mdokin_x)                                  &
     &   , iline_ini(1:2)                                               &
     &   , iline_fin(1:2)
!
      integer                                                           &
     &     jwwgt_dtspec(1:nspec_x,1:nexpt_x)                            &
     &   , jwwgt_win(1:nwintx_x,1:nspec_x,1:nexpt_x)                    &
     &   , lcrdp_dpen(1:ndpen_tot_x,1:nexpt_x)                          &
!V090911:
!Fixed lcrdp-Bug:
     &   , iexpt_crdp(1:mdpen_tot_x)                                    &
     &   , idpen_crdp(1:mdpen_tot_x)
!:V090911
!
      integer                                                           &
     &     msib_dpen(1:ndpen_tot_x)                                     &
     &   , jdrdp_dpen(1:ndpen_tot_x)                                    &
     &   , jdosib_dpen(1:ndpen_tot_x)                                   &
     &   , ispec_sib(1:msib_dpen_x,1:ndpen_tot_x)                       &
     &   , ispreP_sib(1:msib_dpen_x,1:ndpen_tot_x)                      &
     &   , idpen_sib(1:msib_dpen_x,1:ndpen_tot_x)                       &
     &   , itimeP_sib(1:msib_dpen_x,1:ndpen_tot_x)                      &
     &   , jfunc_sib(1:msib_dpen_x,1:ndpen_tot_x)                       &
     &   , jfox_drdp(1:nspec_x)
!
      integer                                                           &
     &     ncplex(1:nreac_x)                                            &
     &   , iicplex(1:nreac_x)                                           &
     &   , iocplex(1:nreac_x)                                           &
     &   , mpplex(1:npart_x,1:nreac_x)                                  &
     &   , ipart_ini(1:npart_x,1:nreac_x)                               &
     &   , ipart_fin(1:npart_x,1:nreac_x)
!
      integer                                                           &
     &     josc_xtr(0:kosc_hper_x)
!
      integer                                                           &
     &     jblkth_pik(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jblkth_fmt(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jblkth_ord(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jblkth_sco(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , nblkth(1:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , jovr_bcth(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jovr_stp(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , jovr_oth(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , lblkth_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , lblkth_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , kpmb_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , kpmb_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , mpmb_tot(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     jrasf_pik(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jrasf_fmt(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jrasf_ctl(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jrasf_xch(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , nrasf(1:nmvsequ_x,jmvloop_n:jmvloop_x)                       &
     &   , lrasf_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , lrasf_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jmsspec_ch_ks(1:niscal_x)
!
      integer                                                           &
     &     mdconr(1:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , ldconr_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , ldconr_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jmty_ampdc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jdcrspec_pik(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , jdcrspec_fmt(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , jdcpspec_pik(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , jdcpspec_sum(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
!V090912:
     &   , jdcckev(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
!:V090912
     &   , mdconp(1:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , ldconp_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , ldconp_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , jdcpspec_fmt(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     mdconfz(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , ldconfz_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                 &
     &   , ldconfz_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                 &
     &   , jdcfz_pik(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jdcfz_fmt(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jdcon_stp(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , jdcon_bc(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     ndcsweep(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , mthb_tot(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , mthb_spec(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , mthb_reac(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , kthb_tot_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , kthb_tot_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , kthb_spec_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)               &
     &   , kthb_spec_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)               &
     &   , kthb_reac_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)               &
     &   , kthb_reac_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     kampdv_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , kampdv_fin(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , kampdu_ini(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , mampdu_tot(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      integer                                                           &
     &     ipm_lo_blkth(1:lblkth_x)                                     &
     &   , ipm_hi_blkth(1:lblkth_x)                                     &
     &   , ipm_str_blkth(1:lblkth_x)                                    &
     &   , ispre_str_blkth(1:lblkth_x)                                  &
     &   , jipm_str_blkth(1:lblkth_x)                                   &
     &   , jispre_str_blkth(1:lblkth_x)                                 &
     &   , jbc_blkth(1:lblkth_x)                                        &
     &   , jstp_blkth(1:lblkth_x)                                       &
     &   , jbc_lo_blkth(1:lblkth_x)                                     &
     &   , jbc_hi_blkth(1:lblkth_x)                                     &
     &   , jstp_wid_blkth(1:lblkth_x)                                   &
     &   , ispre_lo_blkth(1:lblkth_x)                                   &
     &   , ispre_hi_blkth(1:lblkth_x)                                   &
     &   , kthb_inilb(1:lblkth_x)                                       &
     &   , kthb_finlb(1:lblkth_x)                                       &
     &   , kpmb_inilb(1:lblkth_x)                                       &
     &   , kpmb_finlb(1:lblkth_x)
!
      integer                                                           &
     &     ithc_thblk(1:kthblk_x)                                       &
     &   , ithc_no_thblk(1:kthblk_x)                                    &
     &   , ispre_pmblk(1:kpmblk_x)                                      &
     &   , ipm_pmblk(1:kpmblk_x)
!
      integer                                                           &
     &     lscalog_rasf(1:lrasf_x)                                      &
     &   , lscalin_rasf(1:lrasf_x)                                      &
     &   , ipm_rasf(1:lrasf_x)                                          &
     &   , ispre_rasf(1:lrasf_x)
!
      integer                                                           &
     &     irspec_dconr(1:ldconr_x)                                     &
     &   , ipspec_dconp(1:ldconp_x)                                     &
     &   , kampdv_inips(1:ldconp_x)                                     &
     &   , kampdv_finps(1:ldconp_x)                                     &
     &   , kampdu_inips(1:ldconp_x)                                     &
     &   , mampdu_ps(1:ldconp_x)                                        &
     &   , irspec_dconfz(1:ldconfz_x)                                   &
     &   , ipspec_dconfz(1:ldconfz_x)
!
      integer                                                           &
     &     ispre_ampdv(1:kampdv_x)                                      &
     &   , ipm_ampdv(1:kampdv_x)                                        &
     &   , irspec_ampdv(1:kampdv_x)                                     &
     &   , ipspec_ampdv(1:kampdv_x)                                     &
     &   , kampdu_ampdv(1:kampdv_x)
!
      integer                                                           &
     &     ispre_ampdu(1:kampdu_x)                                      &
     &   , ipm_ampdu(1:kampdu_x)
!
      integer                                                           &
     &     itsxdc_ini(1:nspec_x,1:nexpt_x)                              &
     &   , itsxdc_fin(1:nspec_x,1:nexpt_x)                              &
     &   , itsxdc_inixp(1:nexpt_x)                                      &
     &   , itsxdc_finxp(1:nexpt_x)                                      &
     &   , mtsxdc_xpt(1:nexpt_x)                                        &
     &   , itxpt_tsxdc(1:ntsxdc_x)                                      &
     &   , irspec_tsxdc(1:ntsxdc_x)                                     &
     &   , itmx0_txdc(1:ntxdc_x)                                        &
     &   , itmx_txdc(1:ntxdc_x)
!
!DRLIM190524-2244:
      integer                                                           &
      &    jout_limd(1:mth_limd_x)                                      &
      &  , njlimd(1:mth_limd_x)                                         &
      &  , nmlimd(1:mth_limd_x)                                         &
      &  , nplimd(1:mth_limd_x)                                         &
      &  , n_drv_xp(1:nexpt_x)
!:DRLIM190524-2244
!
!mp_< user mp-variables and mp-arrays
      integer                                                           &
     &     jmp_busy(0:(mp_nproc_x-1))                                   &
     &   , jmp_recv(0:(mp_nproc_x-1))                                   &
     &   , jmp_fin_yspec(0:(mp_nproc_x-1))                              &
     &   , jmp_fin_arkabd(0:(mp_nproc_x-1))                             &
     &   , mp_iexpt_sbuf(0:(mp_nproc_x-1))                              &
!V090909:
!Fixed Bug 090909:
!!!  &   , jmp_isend(1:mp_nproc_x,1:mp_nreq_x)                          &
     &   , jmp_isend(1:(mp_nreq_x*mp_nproc_x))                          &
     &   , mp_hand(1:(mp_nreq_x*mp_nproc_x))                            &
!:V090909
     &   , mp_dim_yspec(1:nexpt_x)                                      &
     &   , mp_dim_yspec1(1:nexpt_x)                                     &
     &   , mp_dim_yspec2(1:nexpt_x)                                     &
     &   , mp_dim_yspec4(1:nexpt_x)                                     &
     &   , mp_nsend(1:mp_ntag_x)                                        &
     &   , mp_nrecv(1:mp_ntag_x,1:3)
!>mp_
!
      real*8                                                            &
     &     time0, time1, dtime, timei, glob_scal, beta_tot, amwgt       &
     &   , temp_mc, widlog_spec, fstp_swo_xst, fstp_swo_yst, arenorm    &
     &   , tlo, thi, txpt, ptot, beta_mc, rstep, scalxm_log             &
     &   , theta0, theta1, rreac0, dtheta, dchi0, chi0_o                &
     &   , pi2, rgauss, r1, r2, rr_mvtype, time_o, err_txpt             &
     &   , rweight, rmet, ftmp_imv, fstp_imv, anorm_acc, anorm_r        &
     &   , time_xpt0, time_xpt1, dtime_xpt0, dtime_xpt1                 &
     &   , chisq, chisq_th0, chisq_th, dhtot, chisq_tru, xnew           &
     &   , dchi1, chi1_tru, dchi2, chi2_tru, sxplog_tru                 &
     &   , sxplog, ar_chisq_n, dr_chisq_n, am_chisq_n, tol_amb          &
     &   , ar_chisq, dr_chisq, htot_ham, gamma_ms, gamma_fx             &
     &   , ar_chi1_o, dr_chi1_o, am_chi1_o, time0_o, time1_o            &
     &   , ar_chi2_o, dr_chi2_o, am_chi2_o, odtime, xspec_xpt_out       &
     &   , ar_sxplog_o, dr_sxplog_o, am_sxplog_o, yspec_xpt_out         &
     &   , ekin_th0, ekin_th, err_pi, err_th, force_th, dhtot_xst       &
     &   , devl_th, dtfic_swo, dtfic_swoh, dtfic, fderiv_th             &
     &   , dderiv_th, ra_swo_hi, ra_swo_lo, dekin, raccp_swo0           &
     &   , eps_time, tpulse_tif, tshift, time_ib, time_fb
!
      real*8                                                            &
     &     alnf_dos, alnf_dos0, alnf_dos1, pf_dos, ck_his               &
     &   , deintv, wintv_min, aln_dos_th, aln_dos_th0, enrg_dos         &
     &   , dln_dos, aln_dos, hist_eps, hist_min, hist_max, hist0        &
     &   , a1_his, a2_his, a1ln_his, a2ln_his, wpm_his, wam_his         &
     &   , wpmln_his, wamln_his, d_his, dln_his, alnf_dos_o             &
     &   , htot_cut, chisq_th_min, chisq_th_max, rhi_th, rlo_th         &
     &   , chisq_th_min0, htot_ei_min, htot_ei_max                      &
     &   , step_th, cu_theta, fstp_swo_max, fwgt_tot, txpt_wgt          &
     &   , ahispec, alospec, ahireac, aloreac, ahi_th, alo_th           &
     &   , chisq_th_rst, chisq_th_min_rst, chisq_th_max_rst             &
     &   , chisq_uth_rst, chisq_uth_min_rst, chisq_uth_max_rst          &
     &   , chisq_uth, chisq_uth_min, chisq_uth_min0, chisq_uth_max      &
     &   , rmvtype, rs0, odtxwin_nbintx, xtx, wtx                       &
     &   , chisq_g0u, chisq_n0u, xspec0, xspec1, yspec0, yspec1         &
     &   , zspec0, zspec1, wgt_log, wgt_lin, yspec_wid_out              &
     &   , yspec_tru_out, xspec_tru_out

!
      real*8                                                            &
     &     htot, htot_th, htot_th_min, htot_th_max, htot_th0            &
     &   , htot_tru                                                     &
     &   , htot_rst, htot_th_rst, htot_th_min_rst, htot_th_max_rst      &
     &   , hwall, hwall_th, hwall_th_min, hwall_th_max                  &
     &   , hwall_th0, hwall_tru                                         &
     &   , hwall_rst, hwall_th_rst, hwall_th_min_rst                    &
     &   , hwall_th_max_rst                                             &
     &   , hbxx, hbxx_th, hbxx_th_min, hbxx_th_max, hbxx_th0            &
     &   , hbxx_tru                                                     &
     &   , hbxx_rst, hbxx_th_rst, hbxx_th_min_rst, hbxx_th_max_rst      &
     &   , hbxn, hbxn_th, hbxn_th_min, hbxn_th_max, hbxn_th0            &
     &   , hbxn_tru                                                     &
     &   , hbxn_rst, hbxn_th_rst, hbxn_th_min_rst, hbxn_th_max_rst      &
     &   , xbxx_lo, xbxx_hi, qqbxx_imv, redbxx_imv, fbxx_imv            &
     &   , bxx_lo_imv, bxx_hi_imv, redbxx                               &
     &   , xbxn_lo, xbxn_hi, qqbxn_imv, redbxn_imv, fbxn_imv            &
     &   , bxn_lo_imv, bxn_hi_imv, redbxn
!
      real*8                                                            &
     &     dxspec, xspec_qbx, dtime_bx, onbx_time                       &
     &   , dyspec, yspec_min, yspec_max                                 &
     &   , am_htot, am_hwall, am_hbxx, am_hbxn                          &
     &   , ar_htot, ar_hwall, ar_hbxx, ar_hbxn                          &
     &   , dr_htot, dr_hwall, dr_hbxx, dr_hbxn                          &
     &   , q1bxx, c1bxx, qqbxx, afbxx, afbxx_max                        &
     &   , afbxx_max_imv, ebxx, ebxx_lo                                 &
     &   , q1bxn, c1bxn, qqbxn, afbxn, afbxn_max                        &
     &   , afbxn_max_imv, ebxn, ebxn_lo                                 &
     &   , time_i, time_f, fdtxdi, adum0, adum1, adum2, adum3           &
     &   , dtime_ft, time_ft, dyspec_fft, y1re, y1im, y2re, y2im        &
     &   , ffour_imv, timerk_i, timerk_f, y_qbx, y_lo, y_ct, y_hi       &
     &   , o2nft_time, onft_time, wf_norm, wf_shape                     &
     &   , efour_imv, cfour_imv, pmdpen, bdum1, bdum2, bdum3            &
     &   , time_w2sv, time_w2sv_chek, time_w2sv_last, dtime10
!
      real*8                                                            &
     &     hfour, hfour_th, hfour_th_min, hfour_th_max                  &
     &   , hfour_th_rst, hfour_th_min_rst, hfour_th_max_rst             &
     &   , hfour_tru, hfour_th0, am_hfour, ar_hfour, dr_hfour           &
     &   , hfous, hfous_th, hfous_th_min, hfous_th_max                  &
     &   , hfous_th_rst, hfous_th_min_rst, hfous_th_max_rst             &
     &   , hfous_tru, hfous_th0, am_hfous, ar_hfous, dr_hfous           &
     &   , hfout, hfout_th, hfout_th_min, hfout_th_max                  &
     &   , hfout_th_rst, hfout_th_min_rst, hfout_th_max_rst             &
     &   , hfout_tru, hfout_th0, am_hfout, ar_hfout, dr_hfout
!
      real*8                                                            &
     &     eps_ark, rdtsto_ark, rhini_ark, rhmin1_ark, rhmin2_ark       &
     &   , ark_ksol, ark_kstp_av, ark_kdrv_av, ark_kslo_av              &
     &   , ark_ksolxp, ark_kbad_av, ark_koks_av, ark_ksto_av            &
     &   , abd_kfai_av, abd_krdo_av, abd_krin_av, abd_kjac_av           &
     &   , dtime_ark, dtime_sto, dtime_rl, odtime_rl                    &
     &   , hini_ark, hmin0_ark, hmin1_ark, hmin2_ark                    &
     &   , time_xr, time_f0, txpt0, time_i_fs, dtime_xr                 &
     &   , pmvsum_prv, fbeta_st, fstep_st, althyst, estpst              &
     &   , amthyst, htotge_min, beta_ge, temp_repl                      &
     &   , ansurge, bnsurge, time_fi, time_fo, time_ir, time_fr         &
     &   , densdtin_run, denstarg_run, fwwgt_run
!
      real*8                                                            &
     &     dtime_half, arwgt                                            &
!V091218:
     &   , onintfol, ddtime_half, yfol0, yfolt                          &
     &   , rfol, rfol_p, expdrfol, drfol, sfol, sfol_p                  &
     &   , pfol, pfol_p, pfol_i, pfol_f, dpfol                          &
     &   , qfol, qfol_p, qfol_i, qfol_f, dqfol                          &
     &   , agene, bgene
!:V091218
!
      real*8                                                            &
     &     oscil_tper, oscil_ampl, oscil_base, oscil_phase              &
     &   , oscil_tdamp, oscil_gdamp, oscil_founda, oscil_foundb         &
     &   , oscil_foundg, oscil_foundp, oscil_foundt, tosc_phzero        &
     &   , tosc_wlo, tosc_whi                                           &
     &   , akosc, bdosc, buosc, blosc, epsxosc, epstosc, epsgosc        &
     &   , eosc0, eosc1, eosclg, dxosc0, dxosc1, sxosc0, sxosc1         &
     &   , udosct, udosc1, aosc, rosc, rosclg, gosclg, x0, xm, xp       &
     &   , dx1, dx2, dtx, a0                                            &
     &   , phfour, gmfour, blfour, tpfour, amfour, tifour, rt_tint
!
      real*8                                                            &
     &     hpspecv, hpspecv_tot, hpspecv0_tot, dhphi, zlo, zhi          &
     &   , erfzlo, erfzhi, probz, zprob, ampr_upd, dampr_upd            &
     &   , dhpspecv_tot, dchipspec_th, sxplog_lo_ij, sxplog_hi_ij, ort2 &
     &   , sxplin_lo_ij, sxplin_hi_ij, c1sxplog, c2sxplog, c1sxplin     &
     &   , c2sxplin, sxplog_avg, sxplin_avg, swx_phi, swx_psi           &
     &   , chisq_g0t, chisq_n0t, zpsibar, trphimat, anorm, dampr2       &
     &   , zeta_amplo, zeta_amphi, zeta_lo, zeta_hi, dzeta2, psibarev   &
!
!DRLIM190524-2244:
     &   , zeta_upd, rjlimd_tot, rmlimd_tot
!:DRLIM190524-2244
!
      real*8                                                            &
     &     chi2_is(1:niscal_x)                                          &
     &   , chi2_is_th0(1:niscal_x)                                      &
     &   , chi2_is_th(1:niscal_x)                                       &
     &   , chi2_is_uth(1:niscal_x)                                      &
     &   , chi2_is_tru(1:niscal_x)                                      &
     &   , chi1_is(1:niscal_x)                                          &
     &   , chi1_is_th0(1:niscal_x)                                      &
     &   , chi1_is_th(1:niscal_x)                                       &
     &   , chi1_is_uth(1:niscal_x)                                      &
     &   , chi1_is_tru(1:niscal_x)                                      &
     &   , sxplog_is(1:niscal_x)                                        &
     &   , sxplog_is_th0(1:niscal_x)                                    &
     &   , sxplog_is_th(1:niscal_x)                                     &
     &   , sxplog_is_uth(1:niscal_x)                                    &
     &   , sxplog_is_tru(1:niscal_x)                                    &
     &   , chi0_is(1:niscal_x)                                          &
     &   , chi0_is_u(1:niscal_x)
!
      real*8                                                            &
     &     chi2_ks(1:niscal_x)                                          &
     &   , chi2_ks_th0(1:niscal_x)                                      &
     &   , chi2_ks_th(1:niscal_x)                                       &
     &   , chi2_ks_uth(1:niscal_x)                                      &
     &   , chi1_ks(1:niscal_x)                                          &
     &   , chi1_ks_th0(1:niscal_x)                                      &
     &   , chi1_ks_th(1:niscal_x)                                       &
     &   , chi1_ks_uth(1:niscal_x)                                      &
     &   , sxplog_ks(1:niscal_x)                                        &
     &   , sxplog_ks_th0(1:niscal_x)                                    &
     &   , sxplog_ks_th(1:niscal_x)                                     &
     &   , sxplog_ks_uth(1:niscal_x)                                    &
     &   , chi0_ks(1:niscal_x)                                          &
     &   , chi0_ks_u(1:niscal_x)                                        &
     &   , sxplog_ks_th_rst(1:niscal_x)                                 &
     &   , sxplog_chi(1:niscal_x)                                       &
     &   , sxplin_chi(1:niscal_x)
!
      real*8                                                            &
     &     am_chi2_is(1:niscal_x)                                       &
     &   , ar_chi2_is(1:niscal_x)                                       &
     &   , dr_chi2_is(1:niscal_x)                                       &
     &   , am_chi1_is(1:niscal_x)                                       &
     &   , ar_chi1_is(1:niscal_x)                                       &
     &   , dr_chi1_is(1:niscal_x)                                       &
     &   , am_sxplog_is(1:niscal_x)                                     &
     &   , ar_sxplog_is(1:niscal_x)                                     &
     &   , dr_sxplog_is(1:niscal_x)
!
      real*8                                                            &
     &     am_chi2_ks(1:niscal_x)                                       &
     &   , ar_chi2_ks(1:niscal_x)                                       &
     &   , dr_chi2_ks(1:niscal_x)                                       &
     &   , am_chi1_ks(1:niscal_x)                                       &
     &   , ar_chi1_ks(1:niscal_x)                                       &
     &   , dr_chi1_ks(1:niscal_x)                                       &
     &   , am_sxplog_ks(1:niscal_x)                                     &
     &   , ar_sxplog_ks(1:niscal_x)                                     &
     &   , dr_sxplog_ks(1:niscal_x)                                     &
     &   , am_chisq_lo(jmvloop_n:jmvloop_x)                             &
     &   , am_chisq_hi(jmvloop_n:jmvloop_x)                             &
     &   , temp_repav(jmvloop_n:jmvloop_x)                              &
     &   , beta_repav(jmvloop_n:jmvloop_x)                              &
     &   , am_chisq_th(1:nmc_rep_x)                                     &
     &   , am_chisq_min(1:nmc_rep_x)                                    &
     &   , arenorm_rep(1:nmc_rep_x)                                     &
     &   , amwgt_rep(1:nmc_rep_x)
!
      real*8                                                            &
     &     r_lspec_max(1:nspec_x,jmvloop_n:jmvloop_x)                   &
     &   , a_lspec_max(1:nspec_x,jmvloop_n:jmvloop_x)                   &
     &   , r_lspec_min(1:nspec_x,jmvloop_n:jmvloop_x)                   &
     &   , a_lspec_min(1:nspec_x,jmvloop_n:jmvloop_x)                   &
     &   , a_lvfor(1:nreac_x,jmvloop_n:jmvloop_x)                       &
     &   , a_lvbak(1:nreac_x,jmvloop_n:jmvloop_x)                       &
     &   , a_lvreac(1:nreac_x,jmvloop_n:jmvloop_x)                      &
     &   , r_lvfor(1:nreac_x,jmvloop_n:jmvloop_x)                       &
     &   , r_lvbak(1:nreac_x,jmvloop_n:jmvloop_x)                       &
     &   , r_lvreac(1:nreac_x,jmvloop_n:jmvloop_x)
!
      real*8                                                            &
     &     raccp_lo(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , raccp_hi(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , pmvtype(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , pmvsum(0:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , ftmp_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , fstp_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , pwgt_mc(1:npwgt_x,1:nmvsequ_x,jmvloop_n:jmvloop_x)           &
     &   , pwgt(1:npwgt_x)
!
      real*8                                                            &
     &     vspec(1:(nspec_x+nms_spec_x))                                &
     &   , xspec(1:(nspec_x+nms_spec_x),0:ntime_x)                      &
     &   , xspec_itim(1:(nspec_x+nms_spec_x))                           &
     &   , xspec_ms(1:nms_spec_x)                                       &
     &   , xreac(1:nreac_x,0:ntime_x)                                   &
     &   , time_itim(0:ntime_x)                                         &
     &   , vfor(1:nreac_x)                                              &
     &   , vbak(1:nreac_x)                                              &
     &   , rkfor(1:nreac_x)                                             &
     &   , rkbak(1:nreac_x)                                             &
     &   , rkfor2(1:nreac_x)                                            &
     &   , rkbak2(1:nreac_x)                                            &
     &   , time_xpt(1:ntxpt_x)                                          &
     &   , time_xpt_kt(1:ntxpt_x)                                       &
     &   , time_xpt_kt1(1:ntxpt_x)                                      &
     &   , rt_xpt(1:ntxpt_x)                                            &
     &   , time_tgr(0:ntgri_x)
!
      real*8                                                            &
     &     yspec_chi_th(0:mdtin_x)                                      &
     &   , yspec_chi_th0(0:mdtin_x)                                     &
     &   , yspec_chi(0:mdtin_x)                                         &
     &   , yspec_wid(0:mdtin_x)                                         &
     &   , yspec_xpt(0:mdtin_odp_x)                                     &
     &   , yspec_tru(0:mdtin_x)                                         &
     &   , xspec_chi(0:mdtin_x)                                         &
     &   , xspec_wid(0:mdtin_x)                                         &
     &   , xspec_xpt(0:mdtin_odp_x)                                     &
     &   , xspec_tru(0:mdtin_x)                                         &
     &   ,      fwgt(0:mdtin_x)
!
      real*8                                                            &
     &     cspec(1:nspec_x,0:npmspec_x)                                 &
     &   , pmspec(1:nspec_x,0:npmspec_x,1:nvpmspec_x)                   &
     &   , rhispec(1:mth_spec_x)                                        &
     &   , rlospec(1:mth_spec_x)                                        &
     &   , stepspec(1:mth_spec_x)                                       &
     &   , pmreac(1:nreac_x,1:npmreac_x,1:nvpmreac_x)                   &
     &   , rhireac(1:mth_reac_x)                                        &
     &   , rloreac(1:mth_reac_x)                                        &
     &   , stepreac(1:mth_reac_x)                                       &
     &   , pmparn(1:mparn_x,ndpen_tot_x)                                &
     &   , ti_parn(1:mparn_x,1:ndpen_tot_x)                             &
     &   , pmfunc(1:mparn_x)                                            &
!V090911:
!Fixed lcrdp-Bug:
     &   , crdpen(1:mdpen_tot_x)
!:V090911
!
      real*8                                                            &
     &    tpulse(1:nspec_x,-2:npmspec_x)                                &
     &  , cpulse(1:nspec_x,-2:npmspec_x)                                &
     &  , dtpulse(1:nspec_x,0:npmspec_x)                                &
     &  , spulse(1:nspec_x,-2:npmspec_x)                                &
     &  , tperiod(1:nspec_x)                                            &
     &  , otperiod(1:nspec_x)                                           &
     &  , time_tifal(0:ntifal_x)                                        &
     &  , time_tif(0:ntifode_x)
!
      real*8                                                            &
     &     ar_cspec(1:mth_spec_x,1:npow_spec_x)                         &
     &   , dr_cspec(1:mth_spec_x,1:npow_spec_x)                         &
     &   , am_cspec(1:mth_spec_x,1:npow_spec_x)                         &
     &   , ar_rreac(1:mth_reac_x,1:npow_reac_x)                         &
     &   , dr_rreac(1:mth_reac_x,1:npow_reac_x)                         &
     &   , am_rreac(1:mth_reac_x,1:npow_reac_x)                         &
!V090911:
!Fixed lcrdp-Bug:
     &   , ar_crdpen(1:mdpen_tot_x,1:npow_reac_x)                       &
     &   , dr_crdpen(1:mdpen_tot_x,1:npow_reac_x)                       &
     &   , am_crdpen(1:mdpen_tot_x,1:npow_reac_x)
!:V090911
!
      real*8                                                            &
     &     raccp(0:mth_r_s_x,1:nmvsequ_x                                &
     &          ,jmvloop_n:jmvloop_x,1:ipmty_x)                         &
     &   , raccp_ty(0:mth_r_s_x,1:njmty_x                               &
     &          ,jmvloop_n:jmvloop_x,1:ipmty_x)                         &
     &   , raccp_spec(0:mth_spec_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , raccp_reac(0:mth_reac_x                                      &
     &          ,jmvloop_n:jmvloop_x)                                   &
     &   , raccp_ham(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   , cspec_fin(1:nspec_x)                                         &
     &   , cspec_th(1:mth_spec_x)                                       &
     &   , rreac_th(1:mth_reac_x)                                       &
     &   , rreac(1:nreac_x,npmreac_x)                                   &
     &   , cspec_mine(1:(nspec_x*(1+npmspec_x)))                        &
     &   , rreac_mine(1:(nreac_x*(1+npmreac_x)))
!
      real*8                                                            &
     &     astp_swo(1:mth_swo_x)                                        &
     &   , fstp_swo(1:mth_swo_x)                                        &
     &   , raccp_swo(1:mth_swo_x)                                       &
     &   , out_swo(1:mth_swo_x)                                         &
     &   , enrg_ig(0:ngintv_x)                                          &
     &   , enrg_ie(0:neintv_x1)                                         &
     &   , aln_wintv_ie(0:neintv_x1)                                    &
     &   , wintv_ie(0:neintv_x1)                                        &
     &   , hist_ie(0:neintv_x1)                                         &
     &   , hist_ie_o(0:neintv_x1)                                       &
     &   , aln_dos_ie(0:neintv_x1)                                      &
     &   , aln_dos_ie_o(0:neintv_x1)                                    &
     &   , anum(1:6)
!
      real*8                                                            &
     &   time_dtin(1:ndtin_x)                                           &
     &  ,zspec_xpt(1:ndtin_x)                                           &
     &  ,zspec_wid(1:ndtin_x)                                           &
     &  ,zscal(1:ndtin_x)
!
      real*8                                                            &
     &   aforce_propi(1:mth_tot_x,jmvloop_n:jmvloop_x)                  &
     &  ,aforce_propf(1:mth_tot_x,jmvloop_n:jmvloop_x)                  &
     &  ,aforce_accpf(1:mth_tot_x,jmvloop_n:jmvloop_x)                  &
     &  ,adhevl_propf(1:mth_tot_x,jmvloop_n:jmvloop_x)                  &
     &  ,adhevl_accpf(1:mth_tot_x,jmvloop_n:jmvloop_x)                  &
     &  ,pi_ham(1:mth_tot_x,0:ntfic_x1)                                 &
     &  ,theta_ham(1:mth_tot_x,0:ntfic_x)                               &
     &  ,force_ham(1:mth_tot_x)                                         &
     &  ,pi_ini(1:mth_tot_x), pi_fin(1:mth_tot_x)                       &
     &  ,theta_ini(1:mth_tot_x), theta_fin(1:mth_tot_x)                 &
     &  ,rhi_ham(1:mth_tot_x), rlo_ham(1:mth_tot_x)                     &
     &  ,ahi_ham(1:mth_tot_x), alo_ham(1:mth_tot_x)                     &
     &  ,step_ham(1:mth_tot_x)                                          &
     &  ,omas_ham(1:mth_tot_x)                                          &
     &  ,force_max(1:mth_tot_x)                                         &
     &  ,u_theta(1:mth_tot_x)
!
      real*8                                                            &
     &   htot_ham_propi(jmvloop_n:jmvloop_x)                            &
     &  ,htot_ham_propf(jmvloop_n:jmvloop_x)                            &
     &  ,htot_ham_accpf(jmvloop_n:jmvloop_x)
!
      real*8                                                            &
     &   xspec_o(1:(nspec_x+nms_spec_x),1:no_time_x,1:nexpt_x)          &
     &  ,yspec_o(1:(nspec_x+nms_spec_x),1:no_time_x,1:nexpt_x)          &
     &  ,am_xspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)                              &
     &  ,am_yspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)                              &
     &  ,ar_xspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)                              &
     &  ,ar_yspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)                              &
     &  ,dr_xspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)                              &
     &  ,dr_yspec(1:no_time_x,1:(nspec_x+nms_spec_x)                    &
     &           ,1:nexpt_x,1:npow_spec_x)
!
      real*8                                                            &
     &     xspec_min(1:nspec_x)                                         &
     &   , xspec_max(1:nspec_x)                                         &
     &   , xspec_min_hi(1:nspec_x)                                      &
     &   , xspec_max_lo(1:nspec_x)                                      &
!
     &   , yspec_min_vs(1:(nspec_x+nms_spec_x))                         &
     &   , yspec_max_vs(1:(nspec_x+nms_spec_x))                         &
     &   , yspec_min_hi_vs(1:(nspec_x+nms_spec_x))                      &
     &   , yspec_max_lo_vs(1:(nspec_x+nms_spec_x))                      &
!
     &   , wspec_vs_min(1:nspec_x)                                      &
     &   , wspec_vs_max(1:nspec_x)                                      &
     &   , frlim_vs_min(1:nspec_x)                                      &
     &   , frlim_vs_max(1:nspec_x)                                      &
!
     &   , rtol_lss(1:2)                                                &
     &   , atol_lss(1:(nspec_x+nms_spec_x))                             &
     &   , rwork_lss(1:lrw_lss_x)
!
      real*8                                                            &
     &     omispec_vs(1:npart_x,1:nreac_x)                              &
     &   , omospec_vs(1:npart_x,1:nreac_x)                              &
     &   , hicoop(1:npart_x,1:nreac_x)                                  &
     &   , hocoop(1:(2*npart_x+3),1:nreac_x)                            &
     &   , gispec(1:npart_x,1:nreac_x)                                  &
     &   , gospec(1:npart_x,1:nreac_x)                                  &
     &   , gimult(1:npart_x,1:nreac_x)                                  &
     &   , gomult(1:npart_x,1:nreac_x)                                  &
     &   , gimult_vs(1:npart_x,1:nreac_x)                               &
     &   , gomult_vs(1:npart_x,1:nreac_x)                               &
     &   , ogimult_vs(1:npart_x,1:nreac_x)                              &
     &   , ogomult_vs(1:npart_x,1:nreac_x)
!
      real*8                                                            &
     &     am_qbxx(0:nspec_x), am_fbxx(0:nspec_x)                       &
     &   , ar_qbxx(0:nspec_x), ar_fbxx(0:nspec_x)                       &
     &   , dr_qbxx(0:nspec_x), dr_fbxx(0:nspec_x)                       &
     &   , am_qbxn(0:nspec_x), am_fbxn(0:nspec_x)                       &
     &   , ar_qbxn(0:nspec_x), ar_fbxn(0:nspec_x)                       &
     &   , dr_qbxn(0:nspec_x), dr_fbxn(0:nspec_x)                       &
     &   , cspec_th_rst(1:mth_spec_x)                                   &
     &   , rreac_th_rst(1:mth_reac_x)                                   &
     &   , fstp_swo_rst(1:mth_swo_x)                                    &
     &   , yspec_qbx(1:nspec_x,1:nbx_time_x,1:nexpt_x)                  &
     &   , yspec_qbx_th(1:nspec_x,1:nbx_time_x,1:nexpt_x)               &
     &   , yspec_qbx_th0(1:nspec_x,1:nbx_time_x,1:nexpt_x)              &
     &   , rt_qbx(1:nbx_time_x)                                         &
     &   , time_bx(1:nbx_time_x)
!
      real*8                                                            &
     &        fbxx_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   qqbxx_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , redbxx_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   ,  bxx_lo_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,  bxx_hi_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , fbxx(0:nspec_x), fbxx_th(0:nspec_x)                          &
     &   , fbxx_th0(0:nspec_x), fbxx_th_rst(0:nspec_x)                  &
     &   , qbxx(0:nspec_x), qbxx_th(0:nspec_x)                          &
     &   , qbxx_th0(0:nspec_x), qbxx_fbx(0:nspec_x)                     &
     &   , qbxx_tru(0:nspec_x)                                          &
     &   , ybxx_lo(0:nspec_x), ybxx_ct(0:nspec_x)                       &
     &   , ybxx_hi(0:nspec_x), sbxx(0:nspec_x)                          &
     &   , afbxx_max_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , q2bxx_fbx(0:nspec_x), qbxx_fbxo(0:nspec_x)                   &
     &   , cbxx_fbxo(0:nspec_x)
!
      real*8                                                            &
     &        fbxn_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   qqbxn_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , redbxn_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   ,  bxn_lo_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,  bxn_hi_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , fbxn(0:nspec_x), fbxn_th(0:nspec_x)                          &
     &   , fbxn_th0(0:nspec_x), fbxn_th_rst(0:nspec_x)                  &
     &   , qbxn(0:nspec_x), qbxn_th(0:nspec_x)                          &
     &   , qbxn_th0(0:nspec_x), qbxn_fbx(0:nspec_x)                     &
     &   , qbxn_tru(0:nspec_x)                                          &
     &   , ybxn_lo(0:nspec_x), ybxn_ct(0:nspec_x)                       &
     &   , ybxn_hi(0:nspec_x), sbxn(0:nspec_x)                          &
     &   , afbxn_max_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                &
     &   , q2bxn_fbx(0:nspec_x), qbxn_fbxo(0:nspec_x)                   &
     &   , cbxn_fbxo(0:nspec_x)
!
      real*8                                                            &
!R   &     time_xdii(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                 &
     &     time_xdii(1:1,1:1,1:1)                                       &
!R   &   , otime_xdifi(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)               &
     &   , otime_xdifi(1:1,1:1,1:1)                                     &
!R   &   , chisq_xdi(1:nsegxd_x,1:nms_spec_x,1:nexpt_x)                 &
     &   , chisq_xdi(1:1,1:1,1:1)                                       &
!R   &   , yspec_xdi(1:ntxpt_x,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)       &
     &   , yspec_xdi(1:1,1:1,1:1,1:1)                                   &
!R   &   , sspec_xdi(1:ntxpt_x,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)       &
     &   , sspec_xdi(1:1,1:1,1:1,1:1)                                   &
!R   &   , txpt_xdi(1:ntxpt_x,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)        &
     &   , txpt_xdi(1:1,1:1,1:1,1:1)                                    &
!R   &   , sxplog_xdi(1:ntxpt_x,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)      &
     &   , sxplog_xdi(1:1,1:1,1:1,1:1)                                  &
!R   &   , y_xdi(1:ntxpt_x)                                             &
     &   , y_xdi(1:1)                                                   &
!R   &   , s_xdi(1:ntxpt_x)                                             &
     &   , s_xdi(1:1)                                                   &
!R   &   , t_xdi(1:ntxpt_x)
     &   , t_xdi(1:1)
!
      real*8                                                            &
     &     txwin_lo(1:nwintx_x,1:nspec_x,1:nexpt_x)                     &
     &   , txwin_hi(1:nwintx_x,1:nspec_x,1:nexpt_x)                     &
     &   , ti_avg(1:nbintx_x)                                           &
     &   , zx_avg(1:nbintx_x)                                           &
     &   , zw_avg(1:nbintx_x)
!
      real*8                                                            &
     &     abas_vec(1:nbaxdi_x)                                         &
     &   , wbas_vec(1:nbaxdi_x)                                         &
     &   , fbas_vec(1:(nbaxdi_x+2))                                     &
     &   , umat(1:ntxpt_x,1:nbaxdi_x)                                   &
     &   , vmat(1:nbaxdi_x,1:nbaxdi_x)                                  &
!R   &   , abaxdi(1:nbaxdi_x,1:nsegxd_x,1:nms_spec_x,1:nexpt_x)
     &   , abaxdi(1:1,1:1,1:1,1:1)
!
      real*8                                                            &
     &       ffour_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   efour_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   cfour_mc(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   wfour_sfil(1:nfil_frq_x,1:nsegft_x,1:nexpt_x)              &
     &   ,   bfil_frq(1:nsegft_x,1:nexpt_x)                             &
     &   ,   cfil_frq(1:nsegft_x,1:nexpt_x)                             &
     &   ,   time_fti(1:nsegft_x,1:nexpt_x)                             &
     &   ,   time_ftf(1:nsegft_x,1:nexpt_x)                             &
     &   ,   gfour_spec(1:nspec_x,1:nsegft_x,1:nexpt_x)                 &
     &   ,   rt_ft(0:nft_time_x,1:nsegft_x,1:nexpt_x)                   &
     &   ,   xspec_ft(0:nft_time_x)                                     &
     &   ,   yspec_fft(1:(2*nft_time_x))                                &
!R   &   ,   pfour_xd(0:nft_time_x,1:nsft_spec_x,1:nsegft_x,1:nexpt_x)  &
     &   ,   pfour_xd(0:1,1:1,1:1,1:1)                                  &
!R   &   ,   pfour_xd_tot(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)
     &   ,   pfour_xd_tot(1:1,1:1,1:1)
!
      real*8                                                            &
     &       pfour_seg(1:nsegft_x,1:nexpt_x)                            &
     &   ,   pfour_seg_tru(1:nsegft_x,1:nexpt_x)                        &
     &   ,   pfour_seg_th(1:nsegft_x,1:nexpt_x)                         &
     &   ,   pfour_seg_th0(1:nsegft_x,1:nexpt_x)                        &
     &   ,   am_pfour_seg(1:nsegft_x,1:nexpt_x)                         &
     &   ,   ar_pfour_seg(1:nsegft_x,1:nexpt_x)                         &
     &   ,   dr_pfour_seg(1:nsegft_x,1:nexpt_x)                         &
     &   ,   qfour_seg(1:nsegft_x,1:nexpt_x)                            &
     &   ,   qfour_seg_tru(1:nsegft_x,1:nexpt_x)                        &
     &   ,   qfour_seg_th(1:nsegft_x,1:nexpt_x)                         &
     &   ,   qfour_seg_th0(1:nsegft_x,1:nexpt_x)                        &
     &   ,   am_qfour_seg(1:nsegft_x,1:nexpt_x)                         &
     &   ,   ar_qfour_seg(1:nsegft_x,1:nexpt_x)                         &
     &   ,   dr_qfour_seg(1:nsegft_x,1:nexpt_x)
!
      real*8                                                            &
     &       pfour_sfil(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)             &
     &   ,   pfour_sfil_tru(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)         &
     &   ,   pfour_sfil_th(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   pfour_sfil_th0(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)         &
     &   ,   am_pfour_sfil(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   ar_pfour_sfil(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   dr_pfour_sfil(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)
!
      real*8                                                            &
     &       pfour_stot(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)             &
     &   ,   pfour_stot_tru(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)         &
     &   ,   pfour_stot_th(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   pfour_stot_th0(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)         &
     &   ,   am_pfour_stot(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   ar_pfour_stot(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)          &
     &   ,   dr_pfour_stot(1:nsft_spec_x,1:nsegft_x,1:nexpt_x)
!
      real*8                                                            &
     &       aln_hlo(1:2)                                               &
     &   ,   aln_erx(1:2)                                               &
!
     &   ,   ark_khlo_av(1:2)                                           &
     &   ,   ark_lhlo_av(1:2)                                           &
     &   ,   ark_lerx_av(1:2)                                           &
     &   ,   abd_kist_av(1:7)                                           &
!
     &   ,   ark_kstp(0:ntime_x)                                        &
     &   ,   ark_kdrv(0:ntime_x)                                        &
     &   ,   ark_ksto(0:ntime_x)                                        &
     &   ,   ark_kbad(0:ntime_x)                                        &
     &   ,   ark_koks(0:ntime_x)                                        &
     &   ,   ark_kslo(0:ntime_x)                                        &
     &   ,   ark_khlo(0:ntime_x,1:2)                                    &
     &   ,   ark_lhlo(0:ntime_x,1:2)                                    &
     &   ,   ark_lerx(0:ntime_x,1:2)                                    &
!
     &   ,   abd_kfai(0:ntime_x)                                        &
     &   ,   abd_krdo(0:ntime_x)                                        &
     &   ,   abd_krin(0:ntime_x)                                        &
     &   ,   abd_kjac(0:ntime_x)                                        &
     &   ,   abd_kist(0:ntime_x,1:7)
!
      real*8                                                            &
     &       xspec_i(1:(nspec_x+nms_spec_x),0:3)                        &
     &   ,   xspec_f(1:(nspec_x+nms_spec_x))                            &
     &   ,   xspec_sto(1:(nspec_x+nms_spec_x)                           &
     &   ,                 0:nsto_ark_x)                                &
     &   ,   time_sto(0:nsto_ark_x)
!
      real*8                                                            &
     &       althy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   amthy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   bmthy_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   ,   estp_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   ,   temp_st(1:nmvsequ_x,jmvloop_n:jmvloop_x)                   &
     &   ,   raccp_pop(0:npopst_x)                                      &
     &   ,   astp_pop(0:npopst_x)                                       &
     &   ,   fstp_pop(0:npopst_x)                                       &
     &   ,   beta_st(0:npopst_x)
!
      real*8                                                            &
     &       htot_st(0:npopst_x)                                        &
     &   ,   chisq_st(0:npopst_x)                                       &
     &   ,   theta_st(1:mth_tot_x,0:npopst_x)                           &
     &   ,   htot_st0(0:npopst_x)                                       &
     &   ,   chisq_st0(0:npopst_x)                                      &
     &   ,   theta_st0(1:mth_tot_x,0:npopst_x)                          &
     &   ,   htot_repl(0:nthr_x,1:jtrepl_x)                             &
     &   ,   chisq_repl(0:nthr_x,1:jtrepl_x)                            &
     &   ,   beta_repl(0:nthr_x,1:jtrepl_x)                             &
     &   ,   theta_repl(1:mth_tot_x,0:nthr_x,1:jtrepl_x)                &
     &   ,   htot_y(1:2)                                                &
     &   ,   chisq_y(1:2)
!
      real*8                                                            &
     &     pfsusum(-1:npopge_x)                                         &
     &   , htot_ge(0:npopge_x)                                          &
     &   , chisq_ge(0:npopge_x)                                         &
     &   , theta_ge(1:mth_tot_x,0:npopge_x)                             &
     &   , temp_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , ansur_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , bnsur_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , cnsur_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)                    &
     &   , dnsur_ge(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      real*8                                                            &
     &     dchi11u_ipch(0:nipch_x,0:jfwgt_x)                            &
     &   , dchi21u_ipch(0:nipch_x,0:jfwgt_x)                            &
     &   , dchi220u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , dchi221u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achig10u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achig11u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achig20u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achig21u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achin11u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achin20u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , achin21u_ipch(0:nipch_x,0:jfwgt_x)                           &
     &   , zspec_ipch(0:nipch_x)                                        &
     &   , zspec_ipch_th(0:nipch_x)                                     &
     &   , zspec_ipch_th0(0:nipch_x)
!
      real*8                                                            &
     &     dchi10u_is(1:niscal_x,0:jfwgt_x)                             &
     &   , dchi20u_is(1:niscal_x,0:jfwgt_x)                             &
     &   , achig01u_ks(1:niscal_x,0:jfwgt_x)                            &
     &   , achig02u_ks(1:niscal_x,0:jfwgt_x)                            &
     &   , achig00u(0:jfwgt_x)                                          &
     &   , achin00u(0:jfwgt_x)                                          &
     &   , rt_sig(0:jfwgt_x)                                            &
     &   , chi0u_is(1:niscal_x,0:jfwgt_x)                               &
     &   , chi1u_is(1:niscal_x)                                         &
     &   , chi2u_is(1:niscal_x)                                         &
!
     &   , chisq_g1u(1:niscal_x)                                        &
     &   , chisq_g2u(1:niscal_x)                                        &
     &   , chisq_n1u(1:niscal_x)                                        &
     &   , chisq_n2u(1:niscal_x)
!
      real*8                                                            &
     &     chisq_tx(1:ntxpt_x)                                          &
     &   , chisq_ms(1:nms_spec_x)                                       &
     &   , chisq_xp(1:nexpt_x)                                          &
     &   , chisq_msxp(1:nms_spec_x,1:nexpt_x)                           &
     &   , fwgt_tx(1:ntxpt_x)                                           &
     &   , fwgt_ms(1:nms_spec_x)                                        &
     &   , fwgt_xp(1:nexpt_x)                                           &
     &   , fwgt_msxp(1:nms_spec_x,1:nexpt_x)
!
      real*8                                                            &
     &     fwwgt_dtin(1:ndtin_x)                                        &
     &   , fwwgt_win(1:nwintx_x,1:nspec_x,1:nexpt_x)                    &
     &   , denstarg(1:nwintx_x,1:nspec_x,1:nexpt_x)
!
      real*8                                                            &
     &     pmdpen_sib(1:msib_dpen_x)                                    &
     &   , pmdpen_prev_sib(1:msib_dpen_x)                               &
     &   , vspec_drdp(1:(nspec_x+nms_spec_x))                           &
     &   , vfor_drdp(1:nreac_x)                                         &
     &   , vbak_drdp(1:nreac_x)
!
      real*8                                                            &
     &     tosc_xtr(0:kosc_hper_x)                                      &
     &   , xosc_xtr(0:kosc_hper_x)                                      &
     &   , xtint(0:1)                                                   &
     &   , xspec_sib(1:msib_dpen_x,0:ntime_x)
!
      real*8                                                            &
     &     bc_lo_blkth(1:lblkth_x)                                      &
     &   , bc_hi_blkth(1:lblkth_x)                                      &
     &   , fstp_wid_blkth(1:lblkth_x)
!
      real*8                                                            &
     &     stpdcon(1:nmvsequ_x,jmvloop_n:jmvloop_x)                     &
     &   , bcdcon(1:nmvsequ_x,jmvloop_n:jmvloop_x)                      &
     &   , sxplog_nlo(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , sxplog_nhi(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , sxplin_nlo(1:nmvsequ_x,jmvloop_n:jmvloop_x)                  &
     &   , sxplin_nhi(1:nmvsequ_x,jmvloop_n:jmvloop_x)
!
      real*8                                                            &
     &     sxplog_ras(1:niscal_x)                                       &
     &   , sxplin_ras(1:niscal_x)                                       &
     &   , chisq_g1t(1:niscal_x)                                        &
     &   , chisq_g2t(1:niscal_x)                                        &
     &   , chisq_n1t(1:niscal_x)                                        &
     &   , chisq_n2t(1:niscal_x)                                        &
     &   , sxplog_ras_th(1:niscal_x)                                    &
     &   , sxplin_ras_th(1:niscal_x)                                    &
     &   , c1sxplog_ras_th(1:niscal_x)                                  &
     &   , c2sxplog_ras_th(1:niscal_x)                                  &
     &   , c1sxplin_ras_th(1:niscal_x)                                  &
     &   , c2sxplin_ras_th(1:niscal_x)
!
      real*8                                                            &
     &     ampr_dconr(1:mdconr_x)                                       &
     &   , amprlo_dconr(1:mdconr_x)                                     &
     &   , amprhi_dconr(1:mdconr_x)                                     &
     &   , psivec_dconr(1:mdconr_x)                                     &
     &   , phimat_dconr(1:mdconr_x,1:mdconr_x)
!
      real*8                                                            &
     &     ampr_ampdu(1:mdconr_x)                                       &
     &   , amprlo_ampdu(1:mdconr_x)                                     &
     &   , amprhi_ampdu(1:mdconr_x)                                     &
     &   , ampr_errlo_ampdu(1:mdconr_x)                                 &
     &   , ampr_errhi_ampdu(1:mdconr_x)                                 &
     &   , psivec_ampdu(1:mdconr_x)                                     &
     &   , psibar(1:mdconr_x)                                           &
     &   , phibar(1:mdconr_x)                                           &
     &   , dampr1(1:mdconr_x)                                           &
     &   , ozetabar(1:mdconr_x)                                         &
     &   , zetabar(1:mdconr_x)                                          &
     &   , phimat_ampdu(1:mdconr_x,1:mdconr_x)
!
      real*8                                                            &
     &     uevphi(1:mdconr_x,1:mdconr_x)                                &
     &   , ouevphi(1:mdconr_x,1:mdconr_x)                               &
     &   , phiuev(1:mdconr_x,1:mdconr_x)                                &
     &   , evphi(1:mdconr_x)                                            &
     &   , phifv1(1:mdconr_x)                                           &
     &   , phifv2(1:mdconr_x)                                           &
     &   , ophibar(1:mdconr_x)                                          &
     &   , psiuev(1:mdconr_x)
!
      real*8                                                            &
     &     hpspecv_dconp(1:ldconp_x)                                    &
     &   , hpspecv0_dconp(1:ldconp_x)                                   &
     &   , dhpspecv_dconp(1:ldconp_x)                                   &
     &   , dhpspecv0_dconp(1:ldconp_x)
!
      real*8                                                            &
     &     xspec_tsxdc(1:2,1:ntsxdc_x)                                  &
     &   , xspec_tsxdc_th(1:2,1:ntsxdc_x)                               &
     &   , xspec_tsxdc_th0(1:2,1:ntsxdc_x)                              &
     &   , xspec_txdcr(ntxdc_x,1:mdconr_x)
!
!DRLIM190524-2244:
      real*8                                                            &
     &     rjlimd(1:mth_limd_x)                                         &
     &   , rmlimd(1:mth_limd_x)                                         &
!
     &   , ark_kstp_it(0:ntime_x)                                       &
     &   , ark_kdrv_it(0:ntime_x)                                       &
     &   , ark_ksto_it(0:ntime_x)                                       &
     &   , ark_kbad_it(0:ntime_x)                                       &
     &   , ark_koks_it(0:ntime_x)                                       &
     &   , ark_kslo_it(0:ntime_x)                                       &
     &   , ark_khlo_it(0:ntime_x,1:2)                                   &
     &   , ark_lhlo_it(0:ntime_x,1:2)                                   &
     &   , ark_lerx_it(0:ntime_x,1:2)                                   &
!
     &   , abd_kfai_it(0:ntime_x)                                       &
     &   , abd_krdo_it(0:ntime_x)                                       &
     &   , abd_krin_it(0:ntime_x)                                       &
     &   , abd_kjac_it(0:ntime_x)                                       &
     &   , abd_kist_it(0:ntime_x,1:7)
!:DRLIM190524-2244
!
!
!mp_< user mp-variables and mp-arrays
      real*8                                                            &
     &     theta_pk(1:mp_dim_theta_x)                                   &
     &   , yspec_pk(1:mp_dim_yspec_x)                                   &
     &   , arkabd_pk(1:mp_dim_arkabd_x)
!>mp_
!
!
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!
      common /lv01/ fexist
!
!mp_< user mp-variables and mp-arrays
      common /mp_lv01/ lmp_done
!>mp_
!
!
      common /ch80v01/                                                  &
     &          aline                                                   &
     &        , namespec0                                               &
     &        , nprfix                                                  &
     &        , vcode                                                   &
     &        , name0                                                   &
     &        , name1                                                   &
     &        , namefunc                                                &
     &        , funame, fname, fname0, fname1, ename1, ename2           &
     &        , fname_swap0, fname_swap1, errtag, aname, bname          &
     &        , errtag_ck
!
!mp_< user mp-variables and mp-arrays
      common /mp_ch80v01/                                               &
     &          namtag, namreq
!>mp
!
!
      common /ch80a01/                                                  &
     &         bline                                                    &
     &        ,namespec                                                 &
     &        ,namereac                                                 &
     &        ,nameispec                                                &
     &        ,nameospec                                                &
     &       , namespec_dtspec                                          &
     &       , namespec_o                                               &
     &       , namespec_ms_o                                            &
     &       , namespre                                                 &
     &       , namefunc_dpen                                            &
     &       , nmparn                                                   &
     &       , fname_orf                                                &
     &       , sname_orf                                                &
     &       , namtag_it                                                &
     &       , namreq_ir
!
      common /ch80a02/                                                  &
     &         namespre_lo_blkth                                        &
     &       , namespre_hi_blkth                                        &
     &       , namespre_rasf                                            &
     &       , name_dconr                                               &
     &       , name_dconp                                               &
     &       , namerspec_dconfz                                         &
     &       , namepspec_dconfz
!
!
      common /iv01/                                                     &
     &     jset, nset, iset, nspec, nreac, ispec, ireac, ipart_vs       &
     &   , ntime, ntskip, itime, itime1, mtime, jtime, iun, iline       &
     &   , nmc_rep, nmc_eql, nmc_acc, nmc_upd, jmc_eql, imc_ran         &
     &   , jmvloop, imvsequ, nexpt, jxpt, ntxpt, itxpt, ixpt_ran        &
     &   , jmc_inii, jst_ini, jxref, ipart, ipart1, nwall, nmvth        &
     &   , jo_ar, jo_th, jo_th_xo, jo_xspec, jo_xko, jo_cfi, jo_sxt     &
     &   , jo_th_cu, jo_th_sw, jo_th_wg, jo_th_ft, jo_th_ark            &
     &   , idum1, idum2, ipm, ivpm, npow_spec, npow_reac, jstp_swo0     &
     &   , ith, iuf, iuv, ims, ivs, ith_rk, ith_cs, jrlim, ith_swo      &
     &   , mth_spec, muf_spec, muv_spec, nms_spec, nvs_spec, itag       &
     &   , mth_reac, muf_reac, muv_reac, mit_amb, jbcfic, mpr_swo       &
     &   , mth_tot,  muf_tot,  muv_tot, kmove, jkmove, ivs0, ivs1       &
     &   , itlo, ithi, io_time, no_time, ipart0, nnz_vs, mdtin_odp      &
     &   , ivpm_th, ivpm_uf, ivpm_uv, jinipm_th, iexpt, iout_th         &
     &   , imc_rep, imc_eql, imc_acc, imc_upd, imove, lmvsequ           &
     &   , ith_upd, jprop, jaccp, ipmty, ipow, itfic0, isign_pi         &
     &   , nprop_tot, naccp_tot, ntfic, itfic, ith_ham, ith_half        &
     &   , ispec0, ireac0, ispec_upd, ireac_upd, ipm_upd, lmvgroup      &
     &   , idtin, idtspec, ldtin, ndtin, mdtin, jcl_ham, imc_smp
!
      common /iv02/                                                     &
     &     nit_dos, nck_dos, jnm_dos, jck_his, ngintv, igintv           &
     &   , leintv, ieintv, neintv, jcv_dos, jcv_his, mck_dos            &
     &   , ienrg_dos, nacc_dos, it_dos, nei_vis, iout_dos               &
     &   , ien_base, ien_line, nen_inc, ien_inc, iei_min, iei_max       &
     &   , idum, mo_dos, no_dos, jdiv, jbc_dos, icol, ieintv_o          &
     &   , it_dos_o, jaccp_ek, jaccp_ek_up, jprop_ek_up, ixpt_dtin      &
     &   , jmsfic, jdtfic, jfxfic, jct_th, jbc_th, iun0, iun_rst        &
     &   , niscal, iscal, iscal0, iscal1, lpwgt, iout_th_rst            &
     &   , nkscal, kscal, kscal0, jkrxdi_rst, jchi_min, mdtin_raw       &
     &   , jac_swo, jaccp_up, jprop_up, mth_swo, jmc_inir, jmc_ini_rst  &
     &   , kmvsequ, kmvsequ_lp, itxpt_min, itxpt_max, nmc_smp           &
     &   , ktxpt, ktxpt0, ktxpt1, mtxpt, ltxpt0, ntxpt_inp, imc_rep0    &
     &   , jrstart, jmvloop_rst, imc_rep_rst, imc_eql_rst, imc_rep_min  &
     &   , imc_acc_rst, imc_upd_rst, imvsequ_rst, jmty_rst, jo_th_dprec &
     &   , kmove_rst, imove_rst, kmvsequ_rst, imvsequ0, jo_th_mine      &
     &   , ith_rk_rst, ith_cs_rst, itrapz, ntrapz, ioffs, imine         &
     &   , inc_swo, mo_swo, io_swo, itmx, iipch, iipch0, iipch1         &
     &   , jaccp_xst, jprop_xst, jaccp_xst_up, jprop_xst_up             &
     &   , jsig, jipch_nx, nipch, jfwgt, itime0, jprex, kdum
!
!
      common /iv03/                                                     &
     &     meq_fbx, nbx_time, jo_th_opt1, jo_th_opt2, jo_th_hto         &
     &   , jo_th_bxx, jo_th_bxn, jbx_qb0, ibx_time, neq_fbx             &
     &   , jaf, jnf, nac_fbx, mac_fbx, nac_fbxo, nzdig                  &
     &   , mbase, jo_th_mvs, imvsequ_i, imvsequ_f, imvsequ_o            &
     &   , jo_mvsequ, is_xdi, jseg_on, isegxd, itxpt_i, itxpt_f         &
     &   , nbas, nbas1, ndat, jbas, jkrxdi, jsfxdi, jo_xdi              &
     &   , it_xdi, nbas2, ibas, ivsX, jo_abaxdi, jupd_chi               &
     &   , jupd_abaxdi, jupd_sfxdi, isho_frq, nmine_spec                &
     &   , isegft, is_ft, ifil_frq, nsft_spec, nft_htime                &
     &   , ift_time, ift0, ifth, ift_freq, iftp, iftm                   &
     &   , is_ft1, iodd, isig_ft, is_ft_max, nmine_reac                 &
     &   , jbxx_qb_imv, jbxx_af_imv, jbxx_nf_imv, jbxx_mc_imv           &
     &   , jbxn_qb_imv, jbxn_af_imv, jbxn_nf_imv, jbxn_mc_imv           &
     &   , jsft_xd_imv, jsft_pf_imv, jsft_ln_imv, jsft_mc_imv           &
     &   , jsft_wf_imv, nfour_seg, nstp_ark, jsto_ark                   &
     &   , nsto_ark, nfs_spec, nfs_spec0, ifs, k_fai, k_rdo             &
     &   , k_drv, k_oks, k_bad, k_sto, k_slo, k_stp, k_jac              &
     &   , k_rin, irkit, nrkit, itime_i, itime_f, jscal
!
      common /iv04/                                                     &
     &     idpen, idpen0, idpen1, ndpen_tot, ndpen_spec                 &
     &   , ndpen_reac, npow_dpen, npmspre0, kdpen                       &
     &   , nspre, ispre, ispre0, ispre1, ispec1, ispec2, ireac1                 &
     &   , ipriodp, mparn, iparn, mparnh, ipm0, ipm1, ipm00             &
     &   , jfunc, jwidxpt, mname, iname, jdpenini0                      &
     &   , jrd_th, jrd_swo, kth_spec_gse, kth_reac_gse                  &
     &   , ispecB, ispecX, itime_parn, jfix0, nspre_i, nspre_ia         &
     &   , ispre_D, ispec_D, ireac_D, ipm_D, ims_D                      &
     &   , ispre_P, ispec_P, ireac_P, ipm_P, ims_P                      &
     &   , idpen_P, jctspre_P, ith_P, ispec_M, ispre4                   &
     &   , iparn_i, iparn_f, ipm_i, ipm_f, jcl_rstart                   &
     &   , jskip12, n0skip12, nrskip12, iskip12, nskip12                &
     &   , iwintx, ibintx, iblok, mblok_ms, jcprs_run, jcprs_i          &
     &   , idtspec_run, nwintx_run, idtin_i, idtin_f, nct_avg_tot       &
     &   , idokin, ldokin0, mdokin, mldokin, jckkin             &
     &   , idokin0, iclass, mclass, nclass, ldokin1, ildokin_i          &
     &   , ildokin_f, jpatki, mpatki, jpatkf, ildokin, jdokin_nz
!
      common /iv05/                                                     &
     &     ljmty, levlp, levlp_nxt, levlp0, kmvsequ_ini                 &
     &   , imvsequ_fst, imvsequ_lst, imvsequ_prv, imvsequ_nxt           &
     &   , iorf, iorf0, iorf1, iorf2, iorfx, iout0, iout1, ioutx        &
     &   , jpst_sch, jinist, jxc1st, jxc2st, jmthyst, jrthyst           &
     &   , mthyst, nparst, npopst, npopst_lst, npopst_sin, ireyst       &
     &   , ipop, ipop_upd, ipop_xch, ipop_pst, jxthyst                  &
     &   , jtrepl, jtrepl0, jtrepl1, kthr, jtmpst, jtmpst_lst           &
     &   , iun_orf, ilev, morf, norf_max, mfoxst, ifoxst                &
     &   , iout_th_rsi, imvsequ_rsi, kmvsequ_rsi, jmvloop_rsi           &
     &   , imc_rep_rsi, imc_eql_rsi, imc_acc_rsi, imc_upd_rsi           &
     &   , jmty_rsi, imove_rsi, jamb_rsi, jpst_rsi, jpge_rsi            &
     &   , jamb_ini, jamb_repl, ipop_pge, ipop_xst, ipop_yst            &
     &   , ipop_xge, kthr_upd, kthr_xch, kmove_rsi, idtspec1            &
     &   , k_fxcount, k_fxh, k_fxo
!
      common /iv06/                                                     &
     &     jidat_amb, mhtot_amb, ihtot_amb, imove_amb, jo_amb           &
     &   , ihtot_amb_ini, ihtot_amb_rst, ict_ham                        &
     &   , jidat_pst, mhtot_pst, ihtot_pst, imove_pst, jo_pst           &
     &   , ihtot_pst_ini, ihtot_pst_rst                                 &
     &   , jidat_pge, mhtot_pge, ihtot_pge, imove_pge, jo_pge           &
     &   , ihtot_pge_ini, ihtot_pge_rst                                 &
     &   , npopge, kxst, ixst, ihupd, ihupd_skip, mth_xch               &
     &   , kthyst, kthyst0, ixge, lhtot_pst, lhtot_ham                  &
     &   , inc_pst0, inc_pst1, inc_yst, inc_ham, inc_amb                &
     &   , jck_thr, jdo_st4ge, jinige, jtmpge, jfsuge, jbsuge           &
     &   , jrsuge, jxsuge, jysuge, jnsuge, nparge                       &
     &   , ipop_fsu, ipop_fsu1, ipop_fsu2, ipop_blo, nsurvge            &
     &   , isurv, ipop_ancs, ipop_rsu, ipop_swp, npopge_lst             &
     &   , npopge_sin, ipop_fsux, isurvx, ipop_ancs0                    &
     &   , nsurvck1, nsurvck2, jpge_sch, ipop1, ipop2
!
      common /iv07/                                                     &
     &     jclC, jclO, ido_lss, jfail_lss, itol_lss, itask_lss          &
     &   , istate_lss, iopt_lss, lrw_lss, liw_lss, nnz_lss              &
     &   , mf_lss, mf_lssr, mflag_lss, jtime_ark, jtime_abd             &
     &   , itgri, ntgri, mshift, ipulse, itifal, itif                   &
     &   , ntifal_ini, ntifal_fin, itifode, ntifode, jtifode            &
     &   , ntifode_prv, npwgt_tot, iexpt0, iexpt1, ims0, ims1           &
     &   , itxpt0, itxpt1, ipwgt, jrand, iseed2, lcrdp                  &
     &   , jwwgt_run, mdpen_tot, mdpen_spec, mdpen_reac, lcrdp0         &
     &   , ierrtag, jerrtag, iexpt_bgun, iexpt_pak, iexpt_upk           &
     &   , istat_ofile, istat_rc, jmp_stat_procs, jmp_comid
!
      common /iv08/                                                     &
     &     jgmult, isib, ispec_drdp, jtime_drdp, ipriodp1, itimep       &
     &   , icplex                                                       &
!V091218:
     &   , jfol_opt1, jfol_opt2, nintfol                                &
     &   , nagene, nbgene, npprod, nqdegr, igene, iintfol
!:V091218
!
      common /iv09/                                                     &
     &     josc_dbase, josc_find, josc_twlo, josc_twhi, josc_tper       &
     &   , josc_tdamp, josc_tdamp0, josc_tdamp1, josc_phas, josc_ampl   &
     &   , josc_udamp, josc_xtr0, kosc_hper, kosc_xtr, kosc             &
     &   , kosc_ini, kosc_fin, itosc, itosc_wlo, itosc_whi, ispec_osc   &
     &   , jsto_itsib, jfunc_sibn, jfunc_sibx, jfunc0                   &
     &   , idpfour, ndpfour, idpenS, jtavg_xsib, iparn_min, iparn_max
!
      common /iv10/                                                     &
     &     ktsxdc, jmty_ij, lblkth, ldconr, ldconp                      &
     &   , ldconfz, mtsxdc_max, iblkth, mthblk0, mthblk1                &
     &   , idcon, lblkth_tot, ldconr_tot, ldconp_tot, ldconfz_tot       &
     &   , kthblk, kthblk_tot, lblkth_i, lblkth_f, kthblk_i, kthblk_f   &
     &   , kthblk0, kthblk1, mdcon_rpspec, kth_upd                      &
     &   , kpmblk, kpmblk0, kpmblk_tot, kampdv, kampdu                  &
     &   , kampdv1, kampdv2, iampdu1, iampdu2, idconr1, idconr2, idconr &
     &   , kampdv_tot, kampdu_tot, ipspec, irspec, ldconr1              &
     &   , ldconr2, itsxdc, itsxdc0, itsxdc1, itsxdc2, ntsxdc_tot       &
     &   , itxdc, ntxdc, ntxdc0, ipm2, jerrivn, jerrtg                  &
     &   , jmsip, irspec1, irspec2, ith2, ispre2, iampdu_upd            &
     &   , idcsweep, idcsweep_tot, ith_ampdv, ithc, ithc0, lrasf, irasf &
     &   , jrasf_ctl_ij, jrasf_fmt_ij, jrasf_xch_ij, jrasf_ctl_log      &
     &   , jrasf_ctl_lin, jrasf_freez, jsto_chiras, jinfin_rasf         &
     &   , lrasf_tot, jpoiss, jclev, jDB_sum_chi, jDB_get_chi           &
     &   , jDB_chi_accu                                                 &
     &   , jevphi, jerr_evphi, ievphi, ievphi0, ievphi_upd, iampdu      &
     &   , jzeta_bound, mratf, nratf
!
!DRLIM190524-2244:
      common /iv11/                                                     &
     &     iexpt_drv, ith_limd, ith_cs_limd, ith_rk_limd                &
     &   , jlimd, jo_th_lmdrv, jo_th_mchi                               &
     &   , mlimdrv, mlimdrv_tot, mth_limd, njlimd_tot, nmlimd_tot       &
     &   , nplimd_tot, nlim_drv, nlim_drv0, nlim_all, n_drv
!:DRLIM190524-2244
!
!
!mp_< user mp-variables and mp-arrays
      common /mp_iv01/                                                  &
     &     mp_nproc, mp_ntag, mp_nreq, mp_ierr, mp_iproc                &
     &   , mp_myid, mp_mrid, mp_svid, mp_qiniid, mp_qfinid              &
     &   , mp_errcode, mp_ipak, mp_dim_theta, mp_dim_arkabd             &
     &   , mp_dim_yspec_inc1, mp_dim_yspec_inc2, mp_dim_yspec_inc4      &
     &   , mp_dim_yspec_inc0                                            &
     &   , mp_mexpt_done, mp_mexpt_dokin, mp_mproc_busy, mp_tag_ub      &
     &   , jmp_task, jmp_kin, jmp_kin0, iun39, mp_w2sv, ireq, mp_isid   &
     &   , kreq
!>mp_
!
!
      common /ia01/                                                     &
     &     iispec                                                       &
     &   , iospec                                                       &
     &   , mispec                                                       &
     &   , mospec                                                       &
     &   , nipart                                                       &
     &   , nopart                                                       &
     &   , iivs_vs                                                      &
     &   , iovs_vs                                                      &
     &   , iispec_vs                                                    &
     &   , iospec_vs                                                    &
     &   , mispec_vs                                                    &
     &   , mospec_vs                                                    &
     &   , nipart_vs                                                    &
     &   , nopart_vs                                                    &
     &   , nireac_vs                                                    &
     &   , noreac_vs                                                    &
     &   , jkin
!
!
      common /ia02/                                                     &
     &     jfix                                                         &
     &   , jfox                                                         &
     &   , npulse                                                       &
     &   , mpulse                                                       &
     &   , nperiod                                                      &
     &   , mth_ty                                                       &
     &   , itime_xpt                                                    &
     &   , ltxpt_kt                                                     &
     &   , itxpt_kt                                                     &
     &   , mdtin_tx                                                     &
     &   , mdtin_ms                                                     &
     &   , mdtin_xp                                                     &
     &   , mdtin_msxp                                                   &
     &   , jmvsched                                                     &
     &   , jrpwgt                                                       &
     &   , nmvsequ                                                      &
     &   , jiline
!
!
      common /ia03/                                                     &
     &     jmty                                                         &
     &   , jnorep                                                       &
     &   , jmty_mc                                                      &
     &   , nmove                                                        &
     &   , jtmp_mv                                                      &
     &   , jtmp_mc                                                      &
     &   , jtmp_en                                                      &
     &   , jtmp_kx                                                      &
     &   , jtmp_sx                                                      &
     &   , jstp_mc                                                      &
     &   , kmvsequ_mvs
!
      common /ia03a/                                                    &
     &     jwgt_mc                                                      &
     &   , jwgt_mv                                                      &
     &   , jwgt_tv                                                      &
     &   , jwgt_sh                                                      &
     &   , jwgt_wc                                                      &
     &   , npwgt                                                        &
     &   , iexpt_wc0                                                    &
     &   , iexpt_wc1                                                    &
     &   , ims_wc0                                                      &
     &   , ims_wc1                                                      &
     &   , itxpt_wc0                                                    &
     &   , itxpt_wc1
!
!
      common /ia04/                                                     &
     &     nprop                                                        &
     &   , naccp                                                        &
     &   , nprop_ty                                                     &
     &   , naccp_ty                                                     &
     &   , nprop_spec                                                   &
     &   , naccp_spec                                                   &
     &   , nprop_reac                                                   &
     &   , naccp_reac                                                   &
     &   , nkin_run
!
      common /ia05/                                                     &
     &     jout_swo                                                     &
     &   , jstp_swo                                                     &
     &   , naccp_swo                                                    &
     &   , naccp_up_swo                                                 &
     &   , nprop_swo                                                    &
     &   , nprop_up_swo
!
      common /ia06/                                                     &
     &     npmspec                                                      &
     &   , jmsspec                                                      &
     &   , ims_spec                                                     &
     &   , ispec_ms                                                     &
     &   , ispec_fs                                                     &
     &   , ispec_vs                                                     &
     &   , ifs_spec                                                     &
     &   , ivs_spec                                                     &
     &   , jnz_vs                                                       &
     &   , lspec_max                                                    &
     &   , lspec_min                                                    &
     &   , lvfor                                                        &
     &   , lvbak                                                        &
     &   , lvreac                                                       &
     &   , npmreac                                                      &
     &   , k_hlo                                                        &
     &   , k_ist                                                        &
     &   , neq_lss                                                      &
     &   , iwork_lss
!
      common /ia07/                                                     &
     &     ndtspec                                                      &
     &   , ntxpt_dtspec                                                 &
     &   , iexpt_dtin                                                   &
     &   , ispec_dtin                                                   &
     &   , itxpt_dtin                                                   &
     &   , jzwid                                                        &
     &   , lscal                                                        &
     &   , jzproc                                                       &
     &   , jbaxdi_dtin                                                  &
     &   , nbaxdi_dtin                                                  &
     &   , jzxdi_dtin                                                   &
     &   , idtin_sxi                                                    &
     &   , idtin_sxf
!
      common /ia07a/                                                    &
     &     lscal_is                                                     &
     &   , lscal_is1                                                    &
     &   , lscal_xpt                                                    &
     &   , iscal_xpt                                                    &
     &   , kscal_xpt                                                    &
     &   , kscal_is                                                     &
     &   , mscal_is                                                     &
     &   , mscal_ks                                                     &
     &   , jcprs_dtspec                                                 &
     &   , nwintx                                                       &
     &   , nbintx                                                       &
     &   , jcprs_win                                                    &
     &   , idtin_avg                                                    &
     &   , lscal_avg                                                    &
     &   , nct_avg                                                      &
     &   , idtspec_blok
!
!
      common /ia08/                                                     &
     &     jctspec                                                      &
     &   , jbcspec                                                      &
     &   , nvpmspec                                                     &
     &   , ispec_th                                                     &
     &   , ispec_uf                                                     &
     &   , ispec_uv                                                     &
     &   , ipmspec_th                                                   &
     &   , ipmspec_uf                                                   &
     &   , ipmspec_uv                                                   &
     &   , itime_o                                                      &
     &   , itxpt_o
!
!
      common /ia09/                                                     &
     &     jctreac                                                      &
     &   , jbcreac                                                      &
     &   , nvpmreac                                                     &
     &   , ireac_th                                                     &
     &   , ireac_uf                                                     &
     &   , ireac_uv                                                     &
     &   , ipmreac_th                                                   &
     &   , ipmreac_uf                                                   &
     &   , ipmreac_uv
!
      common /ia10/                                                     &
     &     nprop_ham_ini                                                &
     &   , nprop_ham_fin                                                &
     &   , naccp_ham_fin                                                &
     &   , nprop_ham                                                    &
     &   , naccp_ham                                                    &
     &   , jct_ham                                                      &
     &   , mgintv                                                       &
     &   , jdv_ig                                                       &
     &   , jei_vis
!
!
      common /ia11/                                                     &
     &     jbxx_mc                                                      &
     &   , jbxx_mv                                                      &
     &   , jbxx_nf                                                      &
     &   , jbxx_af                                                      &
     &   , jbxx_qb                                                      &
     &   , jbxn_mc                                                      &
     &   , jbxn_mv                                                      &
     &   , jbxn_nf                                                      &
     &   , jbxn_af                                                      &
     &   , jbxn_qb                                                      &
     &   , itime_bx                                                     &
     &   , jdig
!
!
      common /ia12/                                                     &
     &     jbaxdi_xpt                                                   &
     &   , jzxdi_xpt                                                    &
     &   , nbaxdi_xpt                                                   &
     &   , is_xdi_spec                                                  &
     &   , is_xdi_vs                                                    &
     &   , ispec_xdi                                                    &
     &   , ispecX_spec                                                  &
     &   , ispecX_xdi                                                   &
     &   , ispecX_vs
!
      common /ia13/                                                     &
     &     itxpt_xdii                                                   &
     &   , itxpt_xdif                                                   &
     &   , itime_xdii                                                   &
     &   , itime_xdif                                                   &
     &   , jbaxdi                                                       &
     &   , ntxdi                                                        &
     &   , nbaxdi                                                       &
     &   , nsegxd                                                       &
     &   , jsegxd                                                       &
     &   , nsxdi_spec                                                   &
     &   , nspec_o
!c   1       , nvs_spec_o
!
      common /ia14/                                                     &
     &     jsft_xd                                                      &
     &   , jsft_wf                                                      &
     &   , jsft_pf                                                      &
     &   , jsft_ln                                                      &
     &   , jsft_mv                                                      &
     &   , jsft_mc                                                      &
     &   , itime_ft                                                     &
     &   , ift_freq_fil                                                 &
     &   , ift_freq_sho                                                 &
     &   , isegxd_sft                                                   &
     &   , lft_time                                                     &
     &   , nft_time                                                     &
     &   , nfil_frq                                                     &
     &   , nsho_frq                                                     &
     &   , jfil_frq
!
      common /ia15/                                                     &
     &     nsegft                                                       &
     &   , ispec_sft                                                    &
     &   , is_ft_spec                                                   &
     &   , jmsspec_ft                                                   &
     &   , jmsspec_px                                                   &
     &   , jmsspec_ip                                                   &
     &   , jmsspec_ch                                                   &
     &   , jrkit_xpt                                                    &
     &   , itime_rki                                                    &
     &   , itxpt_rki                                                    &
!
     &   , jtgri_xpt                                                    &
     &   , itime_tgr                                                    &
     &   , itxpt_tgr                                                    &
     &   , jfin_tif_fs                                                  &
     &   , ipulse_tif_fs                                                &
     &   , mshift_tif_fs
!
!
      common /ia16/                                                     &
     &     jpmspec                                                      &
     &   , npxspec                                                      &
     &   , jpmreac                                                      &
     &   , npxreac                                                      &
     &   , npmspre                                                      &
     &   , kdpen_spre                                                   &
     &   , ispre_nam                                                    &
     &   , idpen_spre                                                   &
     &   , jctspre                                                      &
     &   , jbcspre                                                      &
     &   , ith_spre                                                     &
     &   , jdpenini                                                     &
     &   , idpen_prio
!
      common /ia17/                                                     &
     &     ispre_dpen                                                   &
     &   , ispec_dpen                                                   &
     &   , ireac_dpen                                                   &
     &   , ipm_dpen                                                     &
     &   , mparn_dpen                                                   &
     &   , jprio_dpen                                                   &
     &   , jfunc_dpen                                                   &
     &   , ipm_parn                                                     &
     &   , iti_parn                                                     &
     &   , ispec_parn                                                   &
     &   , ireac_parn                                                   &
     &   , ispre_parn
!
      common /ia18/                                                     &
     &     jini_st                                                      &
     &   , jtmp_st                                                      &
     &   , jxc1_st                                                      &
     &   , jxc2_st                                                      &
     &   , jmthy_st                                                     &
     &   , jrthy_st                                                     &
     &   , jxthy_st                                                     &
     &   , mfox_st                                                      &
     &   , npar_st                                                      &
     &   , npop_st                                                      &
     &   , ljmty_mvs                                                    &
     &   , jmty_mvs                                                     &
     &   , levlp_mvs                                                    &
     &   , nmovr_mvs
!
      common /ia19/                                                     &
     &     imvsequ_fst_mvs                                              &
     &   , imvsequ_lst_mvs                                              &
     &   , imvsequ_prv_mvs                                              &
     &   , imvsequ_nxt_mvs
!
      common /ia20/                                                     &
     &     iout_tr_orf                                                  &
     &   , iout_th_orf                                                  &
     &   , kmvsequ_orf                                                  &
     &   , jmvloop_orf                                                  &
     &   , imove_orf                                                    &
     &   , imvsequ_orf                                                  &
     &   , jnew_orf                                                     &
     &   , imc_rep_orf                                                  &
     &   , imc_eql_orf                                                  &
     &   , imc_acc_orf                                                  &
     &   , imc_upd_orf                                                  &
     &   , jmty_orf                                                     &
     &   , nthr_orf                                                     &
     &   , jtrepl_orf                                                   &
     &   , jorf                                                         &
     &   , iorf_new                                                     &
     &   , iorf_old                                                     &
     &   , iorf_max
!
      common /ia21/                                                     &
     &     imovr_mvs                                                    &
     &   , njmty                                                        &
     &   , jmty_lj                                                      &
     &   , iout_repl                                                    &
     &   , nthr_repl                                                    &
     &   , iorf_repl                                                    &
     &   , ith_xch                                                      &
     &   , imvsequ_lev                                                  &
     &   , imvsequ_fst_lev                                              &
     &   , imvsequ_lst_lev                                              &
     &   , imvsequ_prv_lev                                              &
     &   , imvsequ_nxt_lev                                              &
     &   , iorst                                                        &
     &   , nprop_pop                                                    &
     &   , nprop_up_pop                                                 &
     &   , naccp_pop                                                    &
     &   , naccp_up_pop                                                 &
     &   , jstp_pop
!
      common /ia22/                                                     &
     &     ipop_y                                                       &
     &   , jini_ge                                                      &
     &   , jtmp_ge                                                      &
     &   , jfsu_ge                                                      &
     &   , jnsu_ge                                                      &
     &   , jbsu_ge                                                      &
     &   , jrsu_ge                                                      &
     &   , jxsu_ge                                                      &
     &   , jysu_ge                                                      &
     &   , npar_ge                                                      &
     &   , npop_ge                                                      &
     &   , iorge                                                        &
     &   , jsurv                                                        &
     &   , isurv_pop                                                    &
     &   , ipop_surv                                                    &
     &   , jhoodst
!
      common /ia23/                                                     &
     &     iorge9                                                       &
     &   , jsurv9                                                       &
     &   , isurv9_pop                                                   &
     &   , ipop9_surv                                                   &
     &   , ipop_orge
!
      common /ia24/                                                     &
     &     itmx_xpt                                                     &
     &   , itmx_ini                                                     &
     &   , itmx_fin                                                     &
     &   , itmx_ini_odp                                                 &
     &   , itmx_fin_odp                                                 &
     &   , iipch_ini                                                    &
     &   , iipch_fin                                                    &
     &   , ims_PD                                                       &
     &   , iipch_tmx                                                    &
     &   , itxpt_tmx                                                    &
     &   , kscal_ipch                                                   &
     &   , iscal_ipch                                                   &
     &   , itime_ipch
!
      common /ia25/                                                     &
     &     ldokin                                                       &
     &   , ireac_dokin                                                  &
     &   , ispec_dokin                                                  &
     &   , ipm_dokin                                                    &
     &   , jdokin      &
     &   , jdokin_expt                                                  &
     &   , jdokin_expt0                                                 &
     &   , jdokin_expt1                                                 &
     &   , idokin_spre                                                  &
     &   , ldokin_inp                                                   &
     &   , idokin_inp                                                   &
     &   , iline_dokin                                                  &
     &   , iline_ini                                                    &
     &   , iline_fin
!
      common /ia26/                                                     &
     &     jwwgt_dtspec                                                 &
     &   , jwwgt_win                                                    &
     &   , lcrdp_dpen                                                   &
!V090911:
!Fixed lcrdp-Bug:
     &   , iexpt_crdp                                                   &
     &   , idpen_crdp
!:V090911
!
      common /ia27/         &
     &     msib_dpen     &
     &   , jdrdp_dpen     &
     &   , jdosib_dpen           &
     &   , ispec_sib     &
     &   , ispreP_sib     &
     &   , idpen_sib     &
     &   , itimeP_sib     &
     &   , jfunc_sib      &
     &   , jfox_drdp
!
      common /ia28/         &
     &     ncplex           &
     &   , iicplex           &
     &   , iocplex           &
     &   , mpplex           &
     &   , ipart_ini           &
     &   , ipart_fin
!
      common /ia29/         &
     &     josc_xtr
!
      common /ia30/         &
     &     jblkth_pik                                  &
     &   , jblkth_fmt                                  &
     &   , jblkth_ord                                  &
     &   , jblkth_sco                                  &
     &   , nblkth                                  &
     &   , jovr_bcth                                  &
     &   , jovr_stp                                  &
     &   , jovr_oth                                  &
     &   , lblkth_ini                                  &
     &   , lblkth_fin                                   &
     &   , kpmb_ini                                     &
     &   , kpmb_fin                                     &
     &   , mpmb_tot
!
      common /ia31/                                   &
     &     jrasf_pik                                  &
     &   , jrasf_fmt                                  &
     &   , jrasf_ctl                                  &
     &   , jrasf_xch                                  &
     &   , nrasf                                      &
     &   , lrasf_ini                                  &
     &   , lrasf_fin                                  &
     &   , jmsspec_ch_ks
!
      common /ia32/                                    &
     &     mdconr                                      &
     &   , ldconr_ini                                  &
     &   , ldconr_fin                                  &
     &   , jmty_ampdc                                  &
     &   , jdcrspec_pik                                &
     &   , jdcrspec_fmt                                &
     &   , jdcpspec_pik                                &
     &   , jdcpspec_sum                                &
!V090912:
     &   , jdcckev                                     &
!:V090912
     &   , mdconp                                      &
     &   , ldconp_ini                                  &
     &   , ldconp_fin                                  &
     &   , jdcpspec_fmt
!
      common /ia33/         &
     &     mdconfz                                  &
     &   , ldconfz_ini                                  &
     &   , ldconfz_fin                                  &
     &   , jdcfz_pik                                  &
     &   , jdcfz_fmt                                  &
     &   , jdcon_stp                        &
     &   , jdcon_bc
!
      common /ia34/         &
     &     ndcsweep                                  &
     &   , mthb_tot                                  &
     &   , mthb_spec                                  &
     &   , mthb_reac                                  &
     &   , kthb_tot_ini                               &
     &   , kthb_tot_fin                               &
     &   , kthb_spec_ini                               &
     &   , kthb_spec_fin                               &
     &   , kthb_reac_ini                               &
     &   , kthb_reac_fin
!
      common /ia35/         &
     &     kampdv_ini                                  &
     &   , kampdv_fin                                  &
     &   , kampdu_ini                                  &
     &   , mampdu_tot
!
      common /ia36/         &
     &     ipm_lo_blkth                                  &
     &   , ipm_hi_blkth                                  &
     &   , ipm_str_blkth                                  &
     &   , ispre_str_blkth                                  &
     &   , jipm_str_blkth                                  &
     &   , jispre_str_blkth                                  &
     &   , jbc_blkth                                  &
     &   , jstp_blkth                                  &
     &   , jbc_lo_blkth                                  &
     &   , jbc_hi_blkth                                  &
     &   , jstp_wid_blkth                                  &
     &   , ispre_lo_blkth                                  &
     &   , ispre_hi_blkth                                  &
     &   , kthb_inilb                                  &
     &   , kthb_finlb                                  &
     &   , kpmb_inilb                                  &
     &   , kpmb_finlb
!
      common /ia37/         &
     &     ithc_thblk                                  &
     &   , ithc_no_thblk                                  &
     &   , ispre_pmblk                                  &
     &   , ipm_pmblk
!
      common /ia38/         &
     &     lscalog_rasf               &
     &   , lscalin_rasf               &
     &   , ipm_rasf               &
     &   , ispre_rasf
!
      common /ia39/                          &
     &     irspec_dconr                      &
     &   , ipspec_dconp                      &
     &   , kampdv_inips                      &
     &   , kampdv_finps                      &
     &   , kampdu_inips                      &
     &   , mampdu_ps                         &
     &   , irspec_dconfz                     &
     &   , ipspec_dconfz
!
      common /ia40/                          &
     &     ispre_ampdv                       &
     &   , ipm_ampdv                         &
     &   , irspec_ampdv                      &
     &   , ipspec_ampdv                      &
     &   , kampdu_ampdv
!
      common /ia41/                         &
     &     ispre_ampdu                      &
     &   , ipm_ampdu
!
      common /ia42/         &
     &     itsxdc_ini                      &
     &   , itsxdc_fin                      &
     &   , itsxdc_inixp                      &
     &   , itsxdc_finxp                      &
     &   , mtsxdc_xpt                      &
     &   , itxpt_tsxdc                      &
     &   , irspec_tsxdc                     &
     &   , itmx0_txdc                       &
     &   , itmx_txdc
!
!DRLIM190524-2244:
      common /iv43/                         &
      &    jout_limd                        &
      &  , njlimd                           &
      &  , nmlimd                           &
      &  , nplimd                           &
      &  , n_drv_xp
!:DRLIM190524-2244
!
!mp_< user mp-variables and mp-arrays
      common /mp_ia01/          &
     &     jmp_busy                          &
     &   , jmp_recv                          &
     &   , jmp_fin_yspec                          &
     &   , jmp_fin_arkabd                          &
     &   , mp_iexpt_sbuf                          &
!V090909:
!Fixed Bug 090909:
     &   , jmp_isend                              &
     &   , mp_hand                          &
!:V090909
     &   , mp_dim_yspec                          &
     &   , mp_dim_yspec1                          &
     &   , mp_dim_yspec2                          &
     &   , mp_dim_yspec4              &
     &   , mp_nsend                   &
     &   , mp_nrecv
!>mp_
!
      common /rv01/                                                     &
     &     time0, time1, dtime, timei, glob_scal, beta_tot, amwgt       &
     &   , temp_mc, widlog_spec, fstp_swo_xst, fstp_swo_yst, arenorm    &
     &   , tlo, thi, txpt, ptot, beta_mc, rstep, scalxm_log             &
     &   , theta0, theta1, rreac0, dtheta, dchi0, chi0_o                &
     &   , pi2, rgauss, r1, r2, rr_mvtype, time_o, err_txpt             &
     &   , rweight, rmet, ftmp_imv, fstp_imv, anorm_acc, anorm_r        &
     &   , time_xpt0, time_xpt1, dtime_xpt0, dtime_xpt1                 &
     &   , chisq, chisq_th0, chisq_th, dhtot, chisq_tru, xnew           &
     &   , dchi1, chi1_tru, dchi2, chi2_tru, sxplog_tru                 &
     &   , sxplog, ar_chisq_n, dr_chisq_n, am_chisq_n, tol_amb          &
     &   , ar_chisq, dr_chisq, htot_ham, gamma_ms, gamma_fx             &
     &   , ar_chi1_o, dr_chi1_o, am_chi1_o, time0_o, time1_o            &
     &   , ar_chi2_o, dr_chi2_o, am_chi2_o, odtime, xspec_xpt_out       &
     &   , ar_sxplog_o, dr_sxplog_o, am_sxplog_o, yspec_xpt_out         &
     &   , ekin_th0, ekin_th, err_pi, err_th, force_th, dhtot_xst       &
     &   , devl_th, dtfic_swo, dtfic_swoh, dtfic, fderiv_th             &
     &   , dderiv_th, ra_swo_hi, ra_swo_lo, dekin, raccp_swo0           &
     &   , eps_time, tpulse_tif, tshift, time_ib, time_fb
!
      common /rv02/                                                     &
     &     alnf_dos, alnf_dos0, alnf_dos1, pf_dos, ck_his               &
     &   , deintv, wintv_min, aln_dos_th, aln_dos_th0, enrg_dos         &
     &   , dln_dos, aln_dos, hist_eps, hist_min, hist_max, hist0        &
     &   , a1_his, a2_his, a1ln_his, a2ln_his, wpm_his, wam_his         &
     &   , wpmln_his, wamln_his, d_his, dln_his, alnf_dos_o             &
     &   , htot_cut, chisq_th_min, chisq_th_max, rhi_th, rlo_th         &
     &   , chisq_th_min0, htot_ei_min, htot_ei_max                      &
     &   , step_th, cu_theta, fstp_swo_max, fwgt_tot, txpt_wgt          &
     &   , ahispec, alospec, ahireac, aloreac, ahi_th, alo_th           &
     &   , chisq_th_rst, chisq_th_min_rst, chisq_th_max_rst             &
     &   , chisq_uth_rst, chisq_uth_min_rst, chisq_uth_max_rst          &
     &   , chisq_uth, chisq_uth_min, chisq_uth_min0, chisq_uth_max      &
     &   , rmvtype, rs0, odtxwin_nbintx, xtx, wtx                       &
     &   , chisq_g0u, chisq_n0u, xspec0, xspec1, yspec0, yspec1         &
     &   , zspec0, zspec1, wgt_log, wgt_lin, yspec_wid_out              &
     &   , yspec_tru_out, xspec_tru_out
!
!
      common /rv03/                                                     &
     &     htot, htot_th, htot_th_min, htot_th_max, htot_th0            &
     &   , htot_tru                                                     &
     &   , htot_rst, htot_th_rst, htot_th_min_rst, htot_th_max_rst      &
     &   , hwall, hwall_th, hwall_th_min, hwall_th_max                  &
     &   , hwall_th0, hwall_tru                                         &
     &   , hwall_rst, hwall_th_rst, hwall_th_min_rst                    &
     &   , hwall_th_max_rst                                             &
     &   , hbxx, hbxx_th, hbxx_th_min, hbxx_th_max, hbxx_th0            &
     &   , hbxx_tru                                                     &
     &   , hbxx_rst, hbxx_th_rst, hbxx_th_min_rst, hbxx_th_max_rst      &
     &   , hbxn, hbxn_th, hbxn_th_min, hbxn_th_max, hbxn_th0            &
     &   , hbxn_tru                                                     &
     &   , hbxn_rst, hbxn_th_rst, hbxn_th_min_rst, hbxn_th_max_rst      &
     &   , xbxx_lo, xbxx_hi, qqbxx_imv, redbxx_imv, fbxx_imv            &
     &   , bxx_lo_imv, bxx_hi_imv, redbxx                               &
     &   , xbxn_lo, xbxn_hi, qqbxn_imv, redbxn_imv, fbxn_imv            &
     &   , bxn_lo_imv, bxn_hi_imv, redbxn
!
      common /rv04/                                                     &
     &     dxspec, xspec_qbx, dtime_bx, onbx_time                       &
     &   , dyspec, yspec_min, yspec_max                                 &
     &   , am_htot, am_hwall, am_hbxx, am_hbxn                          &
     &   , ar_htot, ar_hwall, ar_hbxx, ar_hbxn                          &
     &   , dr_htot, dr_hwall, dr_hbxx, dr_hbxn                          &
     &   , q1bxx, c1bxx, qqbxx, afbxx, afbxx_max                        &
     &   , afbxx_max_imv, ebxx, ebxx_lo                                 &
     &   , q1bxn, c1bxn, qqbxn, afbxn, afbxn_max                        &
     &   , afbxn_max_imv, ebxn, ebxn_lo                                 &
     &   , time_i, time_f, fdtxdi, adum0, adum1, adum2, adum3           &
     &   , dtime_ft, time_ft, dyspec_fft, y1re, y1im, y2re, y2im        &
     &   , ffour_imv, timerk_i, timerk_f, y_qbx, y_lo, y_ct, y_hi       &
     &   , o2nft_time, onft_time, wf_norm, wf_shape                     &
     &   , efour_imv, cfour_imv, pmdpen, bdum1, bdum2, bdum3            &
     &   , time_w2sv, time_w2sv_chek, time_w2sv_last, dtime10
!
      common /rv05/                                                     &
     &     hfour, hfour_th, hfour_th_min, hfour_th_max                  &
     &   , hfour_th_rst, hfour_th_min_rst, hfour_th_max_rst             &
     &   , hfour_tru, hfour_th0, am_hfour, ar_hfour, dr_hfour           &
     &   , hfous, hfous_th, hfous_th_min, hfous_th_max                  &
     &   , hfous_th_rst, hfous_th_min_rst, hfous_th_max_rst             &
     &   , hfous_tru, hfous_th0, am_hfous, ar_hfous, dr_hfous           &
     &   , hfout, hfout_th, hfout_th_min, hfout_th_max                  &
     &   , hfout_th_rst, hfout_th_min_rst, hfout_th_max_rst             &
     &   , hfout_tru, hfout_th0, am_hfout, ar_hfout, dr_hfout
!
      common /rv06/                                                     &
     &     eps_ark, rdtsto_ark, rhini_ark, rhmin1_ark, rhmin2_ark       &
     &   , ark_ksol, ark_kstp_av, ark_kdrv_av, ark_kslo_av              &
     &   , ark_ksolxp, ark_kbad_av, ark_koks_av, ark_ksto_av            &
     &   , abd_kfai_av, abd_krdo_av, abd_krin_av, abd_kjac_av           &
     &   , dtime_ark, dtime_sto, dtime_rl, odtime_rl                    &
     &   , hini_ark, hmin0_ark, hmin1_ark, hmin2_ark                    &
     &   , time_xr, time_f0, txpt0, time_i_fs, dtime_xr                 &
     &   , pmvsum_prv, fbeta_st, fstep_st, althyst, estpst              &
     &   , amthyst, htotge_min, beta_ge, temp_repl                      &
     &   , ansurge, bnsurge, time_fi, time_fo, time_ir, time_fr         &
     &   , densdtin_run, denstarg_run, fwwgt_run
!
      common /rv07/                                                     &
     &     dtime_half, arwgt                                            &
!V091218:
     &   , onintfol, ddtime_half, yfol0, yfolt                          &
     &   , rfol, rfol_p, expdrfol, drfol, sfol, sfol_p                  &
     &   , pfol, pfol_p, pfol_i, pfol_f, dpfol                          &
     &   , qfol, qfol_p, qfol_i, qfol_f, dqfol                          &
     &   , agene, bgene
!:V091218
!
      common /rv08/                                                     &
     &     oscil_tper, oscil_ampl, oscil_base, oscil_phase              &
     &   , oscil_tdamp, oscil_gdamp, oscil_founda, oscil_foundb         &
     &   , oscil_foundg, oscil_foundp, oscil_foundt, tosc_phzero        &
     &   , tosc_wlo, tosc_whi                                           &
     &   , akosc, bdosc, buosc, blosc, epsxosc, epstosc, epsgosc        &
     &   , eosc0, eosc1, eosclg, dxosc0, dxosc1, sxosc0, sxosc1         &
     &   , udosct, udosc1, aosc, rosc, rosclg, gosclg, x0, xm, xp       &
     &   , dx1, dx2, dtx, a0                                            &
     &   , phfour, gmfour, blfour, tpfour, amfour, tifour, rt_tint
!
      common /rv08/                                                     &
     &     hpspecv, hpspecv_tot, hpspecv0_tot, dhphi, zlo, zhi          &
     &   , erfzlo, erfzhi, probz, zprob, ampr_upd, dampr_upd            &
     &   , dhpspecv_tot, dchipspec_th, sxplog_lo_ij, sxplog_hi_ij, ort2 &
     &   , sxplin_lo_ij, sxplin_hi_ij, c1sxplog, c2sxplog, c1sxplin     &
     &   , c2sxplin, sxplog_avg, sxplin_avg, swx_phi, swx_psi           &
     &   , chisq_g0t, chisq_n0t, zpsibar, trphimat, anorm, dampr2       &
     &   , zeta_amplo, zeta_amphi, zeta_lo, zeta_hi, dzeta2, psibarev   &
!
!DRLIM190524-2244:
     &   , zeta_upd, rjlimd_tot, rmlimd_tot
!:DRLIM190524-2244
!
      common /ra01/                                                     &
     &     chi2_is                                                      &
     &   , chi2_is_th0                                                  &
     &   , chi2_is_th                                                   &
     &   , chi2_is_uth                                                  &
     &   , chi2_is_tru                                                  &
     &   , chi1_is                                                      &
     &   , chi1_is_th0                                                  &
     &   , chi1_is_th                                                   &
     &   , chi1_is_uth                                                  &
     &   , chi1_is_tru                                                  &
     &   , sxplog_is                                                    &
     &   , sxplog_is_th0                                                &
     &   , sxplog_is_th                                                 &
     &   , sxplog_is_uth                                                &
     &   , sxplog_is_tru                                                &
     &   , chi0_is                                                      &
     &   , chi0_is_u
!
      common /ra01a/                                                    &
     &     chi2_ks                                                      &
     &   , chi2_ks_th0                                                  &
     &   , chi2_ks_th                                                   &
     &   , chi2_ks_uth                                                  &
     &   , chi1_ks                                                      &
     &   , chi1_ks_th0                                                  &
     &   , chi1_ks_th                                                   &
     &   , chi1_ks_uth                                                  &
     &   , sxplog_ks                                                    &
     &   , sxplog_ks_th0                                                &
     &   , sxplog_ks_th                                                 &
     &   , sxplog_ks_uth                                                &
     &   , chi0_ks                                                      &
     &   , chi0_ks_u                                                    &
     &   , sxplog_ks_th_rst                                             &
     &   , sxplog_chi                                                   &
     &   , sxplin_chi
!
      common /ra02/                                                     &
     &     am_chi2_is                                                   &
     &   , ar_chi2_is                                                   &
     &   , dr_chi2_is                                                   &
     &   , am_chi1_is                                                   &
     &   , ar_chi1_is                                                   &
     &   , dr_chi1_is                                                   &
     &   , am_sxplog_is                                                 &
     &   , ar_sxplog_is                                                 &
     &   , dr_sxplog_is
!
      common /ra02a/                                                    &
     &     am_chi2_ks                                                   &
     &   , ar_chi2_ks                                                   &
     &   , dr_chi2_ks                                                   &
     &   , am_chi1_ks                                                   &
     &   , ar_chi1_ks                                                   &
     &   , dr_chi1_ks                                                   &
     &   , am_sxplog_ks                                                 &
     &   , ar_sxplog_ks                                                 &
     &   , dr_sxplog_ks                                                 &
     &   , am_chisq_lo                                                  &
     &   , am_chisq_hi                                                  &
     &   , temp_repav                                                   &
     &   , beta_repav                                                   &
     &   , am_chisq_th                                                  &
     &   , am_chisq_min                                                 &
     &   , arenorm_rep                                                  &
     &   , amwgt_rep
!
      common /ra03/                                                     &
     &     r_lspec_max                                                  &
     &   , a_lspec_max                                                  &
     &   , r_lspec_min                                                  &
     &   , a_lspec_min                                                  &
     &   , a_lvfor                                                      &
     &   , a_lvbak                                                      &
     &   , a_lvreac                                                     &
     &   , r_lvfor                                                      &
     &   , r_lvbak                                                      &
     &   , r_lvreac
!
      common /ra04/                                                     &
     &     raccp_lo                                                     &
     &   , raccp_hi                                                     &
     &   , pmvtype                                                      &
     &   , pmvsum                                                       &
     &   , ftmp_mc                                                      &
     &   , fstp_mc                                                      &
     &   , pwgt_mc                                                      &
     &   , pwgt
!
      common /ra05/                                                     &
     &     vspec                                                        &
     &   , xspec                                                        &
     &   , xspec_itim                                                   &
     &   , xspec_ms                                                     &
     &   , xreac                                                        &
     &   , time_itim                                                    &
     &   , vfor                                                         &
     &   , vbak                                                         &
     &   , rkfor                                                        &
     &   , rkbak                                                        &
     &   , rkfor2                                                       &
     &   , rkbak2                                                       &
     &   , time_xpt                                                     &
     &   , time_xpt_kt                                                  &
     &   , time_xpt_kt1                                                 &
     &   , rt_xpt                                                       &
     &   , time_tgr
!
      common /ra06/                                                     &
     &     yspec_chi_th                                                 &
     &   , yspec_chi_th0                                                &
     &   , yspec_chi                                                    &
     &   , yspec_wid                                                    &
     &   , yspec_xpt                                                    &
     &   , yspec_tru                                                    &
     &   , xspec_chi                                                    &
     &   , xspec_wid                                                    &
     &   , xspec_xpt                                                    &
     &   , xspec_tru                                                    &
     &   ,      fwgt
!
      common /ra07_01/                                                  &
     &     cspec                                                        &
     &   , pmspec                                                       &
     &   , rhispec                                                      &
     &   , rlospec                                                      &
     &   , stepspec                                                     &
     &   , pmreac                                                       &
     &   , rhireac                                                      &
     &   , rloreac                                                      &
     &   , stepreac                                                     &
     &   , pmparn                                                       &
     &   , ti_parn                                                      &
     &   , pmfunc                                                       &
     &   , crdpen
!
      common /ra07_02/                                                  &
     &    tpulse                                                        &
     &  , cpulse                                                        &
     &  , dtpulse                                                       &
     &  , spulse                                                        &
     &  , tperiod                                                       &
     &  , otperiod                                                      &
     &  , time_tifal                                                    &
     &  , time_tif
!
      common /ra08_01/                                                  &
     &     ar_cspec                                                     &
     &   , dr_cspec                                                     &
     &   , am_cspec                                                     &
     &   , ar_rreac                                                     &
     &   , dr_rreac                                                     &
     &   , am_rreac                                                     &
     &   , ar_crdpen                                                    &
     &   , dr_crdpen                                                    &
     &   , am_crdpen
!
      common /ra08_02/                                                  &
     &     raccp                                                        &
     &   , raccp_ty                                                     &
     &   , raccp_spec                                                   &
     &   , raccp_reac                                                   &
     &   , raccp_ham                                                    &
     &   , cspec_fin                                                    &
     &   , cspec_th                                                     &
     &   , rreac_th                                                     &
     &   , rreac                                                        &
     &   , cspec_mine                                                   &
     &   , rreac_mine
!
      common /ra09/                                                     &
     &     astp_swo                                                     &
     &   , fstp_swo                                                     &
     &   , raccp_swo                                                    &
     &   , out_swo                                                      &
     &   , enrg_ig                                                      &
     &   , enrg_ie                                                      &
     &   , aln_wintv_ie                                                 &
     &   , wintv_ie                                                     &
     &   , hist_ie                                                      &
     &   , hist_ie_o                                                    &
     &   , aln_dos_ie                                                   &
     &   , aln_dos_ie_o                                                 &
     &   , anum
!
      common /ra10/                                                     &
     &   time_dtin                                                      &
     &  ,zspec_xpt                                                      &
     &  ,zspec_wid                                                      &
     &  ,zscal
!
      common /ra11/                                                     &
     &   aforce_propi                                                   &
     &  ,aforce_propf                                                   &
     &  ,aforce_accpf                                                   &
     &  ,adhevl_propf                                                   &
     &  ,adhevl_accpf                                                   &
     &  ,pi_ham                                                         &
     &  ,theta_ham                                                      &
     &  ,force_ham                                                      &
     &  ,pi_ini, pi_fin                                                 &
     &  ,theta_ini, theta_fin                                           &
     &  ,rhi_ham, rlo_ham                                               &
     &  ,ahi_ham, alo_ham                                               &
     &  ,step_ham                                                       &
     &  ,omas_ham                                                       &
     &  ,force_max                                                      &
     &  ,u_theta
!
      common /ra12/                                                     &
     &   htot_ham_propi                                                 &
     &  ,htot_ham_propf                                                 &
     &  ,htot_ham_accpf
!
      common /ra13/                                                     &
     &   xspec_o                                                        &
     &  ,yspec_o                                                        &
     &  ,am_xspec                                                       &
     &  ,am_yspec                                                       &
     &  ,ar_xspec                                                       &
     &  ,ar_yspec                                                       &
     &  ,dr_xspec                                                       &
     &  ,dr_yspec
!
      common /ra14/                                                     &
     &     xspec_min                                                    &
     &   , xspec_max                                                    &
     &   , xspec_min_hi                                                 &
     &   , xspec_max_lo                                                 &
!
     &   , yspec_min_vs                                                 &
     &   , yspec_max_vs                                                 &
     &   , yspec_min_hi_vs                                              &
     &   , yspec_max_lo_vs                                              &
!
     &   , wspec_vs_min                                                 &
     &   , wspec_vs_max                                                 &
     &   , frlim_vs_min                                                 &
     &   , frlim_vs_max                                                 &
!
     &   , rtol_lss                                                     &
     &   , atol_lss                                                     &
     &   , rwork_lss
!
!
      common /ra14_1/                                                   &
     &     omispec_vs                                                   &
     &   , omospec_vs                                                   &
     &   , hicoop                                                       &
     &   , hocoop                                                       &
     &   , gispec                                                       &
     &   , gospec                                                       &
     &   , gimult                                                       &
     &   , gomult                                                       &
     &   , gimult_vs                                                    &
     &   , gomult_vs                                                    &
     &   , ogimult_vs                                                   &
     &   , ogomult_vs
!
!
      common /ra15/                                                     &
     &     am_qbxx, am_fbxx                                             &
     &   , ar_qbxx, ar_fbxx                                             &
     &   , dr_qbxx, dr_fbxx                                             &
     &   , am_qbxn, am_fbxn                                             &
     &   , ar_qbxn, ar_fbxn                                             &
     &   , dr_qbxn, dr_fbxn                                             &
     &   , cspec_th_rst                                                 &
     &   , rreac_th_rst                                                 &
     &   , fstp_swo_rst                                                 &
     &   , yspec_qbx                                                    &
     &   , yspec_qbx_th                                                 &
     &   , yspec_qbx_th0                                                &
     &   , rt_qbx                                                       &
     &   , time_bx
!
      common /ra16/                                                     &
     &        fbxx_mc                                                   &
     &   ,   qqbxx_mc                                                   &
     &   , redbxx_mc                                                    &
     &   ,  bxx_lo_mc                                                   &
     &   ,  bxx_hi_mc                                                   &
     &   , fbxx, fbxx_th                                                &
     &   , fbxx_th0, fbxx_th_rst                                        &
     &   , qbxx, qbxx_th                                                &
     &   , qbxx_th0, qbxx_fbx                                           &
     &   , qbxx_tru                                                     &
     &   , ybxx_lo, ybxx_ct                                             &
     &   , ybxx_hi, sbxx                                                &
     &   , afbxx_max_mc                                                 &
     &   , q2bxx_fbx, qbxx_fbxo                                         &
     &   , cbxx_fbxo
!
      common /ra17/                                                     &
     &        fbxn_mc                                                   &
     &   ,   qqbxn_mc                                                   &
     &   , redbxn_mc                                                    &
     &   ,  bxn_lo_mc                                                   &
     &   ,  bxn_hi_mc                                                   &
     &   , fbxn, fbxn_th                                                &
     &   , fbxn_th0, fbxn_th_rst                                        &
     &   , qbxn, qbxn_th                                                &
     &   , qbxn_th0, qbxn_fbx                                           &
     &   , qbxn_tru                                                     &
     &   , ybxn_lo, ybxn_ct                                             &
     &   , ybxn_hi, sbxn                                                &
     &   , afbxn_max_mc                                                 &
     &   , q2bxn_fbx, qbxn_fbxo                                         &
     &   , cbxn_fbxo
!
      common /ra18/                                                     &
     &     time_xdii                                                    &
     &   , otime_xdifi                                                  &
     &   , chisq_xdi                                                    &
     &   , yspec_xdi                                                    &
     &   , sspec_xdi                                                    &
     &   , txpt_xdi                                                     &
     &   , sxplog_xdi                                                   &
     &   , y_xdi                                                        &
     &   , s_xdi                                                        &
     &   , t_xdi
!
      common /ra18a/                                                    &
     &     txwin_lo                                                     &
     &   , txwin_hi                                                     &
     &   , ti_avg                                                       &
     &   , zx_avg                                                       &
     &   , zw_avg
!
      common /ra19/                                                     &
     &     abas_vec                                                     &
     &   , wbas_vec                                                     &
     &   , fbas_vec                                                     &
     &   , umat                                                         &
     &   , vmat                                                         &
     &   , abaxdi
!
!
      common /ra20/                                                     &
     &       ffour_mc                                                   &
     &   ,   efour_mc                                                   &
     &   ,   cfour_mc                                                   &
     &   ,   wfour_sfil                                                 &
     &   ,   bfil_frq                                                   &
     &   ,   cfil_frq                                                   &
     &   ,   time_fti                                                   &
     &   ,   time_ftf                                                   &
     &   ,   gfour_spec                                                 &
     &   ,   rt_ft                                                      &
     &   ,   xspec_ft                                                   &
     &   ,   yspec_fft                                                  &
     &   ,   pfour_xd                                                   &
     &   ,   pfour_xd_tot
!
      common /ra21/                                                     &
     &       pfour_seg                                                  &
     &   ,   pfour_seg_tru                                              &
     &   ,   pfour_seg_th                                               &
     &   ,   pfour_seg_th0                                              &
     &   ,   am_pfour_seg                                               &
     &   ,   ar_pfour_seg                                               &
     &   ,   dr_pfour_seg                                               &
     &   ,   qfour_seg                                                  &
     &   ,   qfour_seg_tru                                              &
     &   ,   qfour_seg_th                                               &
     &   ,   qfour_seg_th0                                              &
     &   ,   am_qfour_seg                                               &
     &   ,   ar_qfour_seg                                               &
     &   ,   dr_qfour_seg
!
      common /ra22/                                                     &
     &       pfour_sfil                                                 &
     &   ,   pfour_sfil_tru                                             &
     &   ,   pfour_sfil_th                                              &
     &   ,   pfour_sfil_th0                                             &
     &   ,   am_pfour_sfil                                              &
     &   ,   ar_pfour_sfil                                              &
     &   ,   dr_pfour_sfil
!
      common /ra23/                                                     &
     &       pfour_stot                                                 &
     &   ,   pfour_stot_tru                                             &
     &   ,   pfour_stot_th                                              &
     &   ,   pfour_stot_th0                                             &
     &   ,   am_pfour_stot                                              &
     &   ,   ar_pfour_stot                                              &
     &   ,   dr_pfour_stot
!
      common /ra24/                                                     &
     &       aln_hlo                                                    &
     &   ,   aln_erx                                                    &
!
     &   ,   ark_khlo_av                                                &
     &   ,   ark_lhlo_av                                                &
     &   ,   ark_lerx_av                                                &
     &   ,   abd_kist_av                                                &
!
     &   ,   ark_kstp                                                   &
     &   ,   ark_kdrv                                                   &
     &   ,   ark_ksto                                                   &
     &   ,   ark_kbad                                                   &
     &   ,   ark_koks                                                   &
     &   ,   ark_kslo                                                   &
     &   ,   ark_khlo                                                   &
     &   ,   ark_lhlo                                                   &
     &   ,   ark_lerx                                                   &
!
     &   ,   abd_kfai                                                   &
     &   ,   abd_krdo                                                   &
     &   ,   abd_krin                                                   &
     &   ,   abd_kjac                                                   &
     &   ,   abd_kist
!
      common /ra25/                                                     &
     &       xspec_i                                                    &
     &   ,   xspec_f                                                    &
     &   ,   xspec_sto                                                  &
     &   ,   time_sto
!
      common /ra26/                                                     &
     &       althy_st                                                   &
     &   ,   amthy_st                                                   &
     &   ,   bmthy_st                                                   &
     &   ,   estp_st                                                    &
     &   ,   temp_st                                                    &
     &   ,   raccp_pop                                                  &
     &   ,   astp_pop                                                   &
     &   ,   fstp_pop                                                   &
     &   ,   beta_st
!
      common /ra27/                                                     &
     &       htot_st                                                    &
     &   ,   chisq_st                                                   &
     &   ,   theta_st                                                   &
     &   ,   htot_st0                                                   &
     &   ,   chisq_st0                                                  &
     &   ,   theta_st0                                                  &
     &   ,   htot_repl                                                  &
     &   ,   chisq_repl                                                 &
     &   ,   beta_repl                                                  &
     &   ,   theta_repl                                                 &
     &   ,   htot_y                                                     &
     &   ,   chisq_y
!
      common /ra28/                                                     &
     &     pfsusum                                                      &
     &   , htot_ge                                                      &
     &   , chisq_ge                                                     &
     &   , theta_ge                                                     &
     &   , temp_ge                                                      &
     &   , ansur_ge                                                     &
     &   , bnsur_ge                                                     &
     &   , cnsur_ge                                                     &
     &   , dnsur_ge
!
      common /ra29/                                                     &
     &     dchi11u_ipch                                                 &
     &   , dchi21u_ipch                                                 &
     &   , dchi220u_ipch                                                &
     &   , dchi221u_ipch                                                &
     &   , achig10u_ipch                                                &
     &   , achig11u_ipch                                                &
     &   , achig20u_ipch                                                &
     &   , achig21u_ipch                                                &
     &   , achin11u_ipch                                                &
     &   , achin20u_ipch                                                &
     &   , achin21u_ipch                                                &
     &   , zspec_ipch                                                   &
     &   , zspec_ipch_th                                                &
     &   , zspec_ipch_th0
!
      common /ra30/                                                     &
     &     dchi10u_is                                                   &
     &   , dchi20u_is                                                   &
     &   , achig01u_ks                                                  &
     &   , achig02u_ks                                                  &
     &   , achig00u                                                     &
     &   , achin00u                                                     &
     &   , rt_sig                                                       &
     &   , chi0u_is                                                     &
     &   , chi1u_is                                                     &
     &   , chi2u_is                                                     &
!
     &   , chisq_g1u                                                    &
     &   , chisq_g2u                                                    &
     &   , chisq_n1u                                                    &
     &   , chisq_n2u
!
      common /ra31/                                                     &
     &     chisq_tx                                                     &
     &   , chisq_ms                                                     &
     &   , chisq_xp                                                     &
     &   , chisq_msxp                                                   &
     &   , fwgt_tx                                                      &
     &   , fwgt_ms                                                      &
     &   , fwgt_xp                                                      &
     &   , fwgt_msxp
!
      common /ra32/                                                     &
     &     fwwgt_dtin                                                   &
     &   , fwwgt_win                                                    &
     &   , denstarg
!
      common /ra33/                &
     &     pmdpen_sib              &
     &   , pmdpen_prev_sib         &
     &   , vspec_drdp              &
     &   , vfor_drdp               &
     &   , vbak_drdp
!
      common /ra34/                &
     &     tosc_xtr                &
     &   , xosc_xtr                &
     &   , xtint                   &
     &   , xspec_sib
!
      common /ra35/                &
     &     bc_lo_blkth             &
     &   , bc_hi_blkth             &
     &   , fstp_wid_blkth
!
      common /ra36/                &
     &     stpdcon                 &
     &   , bcdcon                  &
     &   , sxplog_nlo              &
     &   , sxplog_nhi              &
     &   , sxplin_nlo              &
     &   , sxplin_nhi
!
      common /ra37/                &
     &     sxplog_ras              &
     &   , sxplin_ras              &
     &   , chisq_g1t               &
     &   , chisq_g2t               &
     &   , chisq_n1t               &
     &   , chisq_n2t               &
     &   , sxplog_ras_th           &
     &   , sxplin_ras_th           &
     &   , c1sxplog_ras_th         &
     &   , c2sxplog_ras_th         &
     &   , c1sxplin_ras_th         &
     &   , c2sxplin_ras_th
!
      common /ra38/                &
     &     ampr_dconr              &
     &   , amprlo_dconr            &
     &   , amprhi_dconr            &
     &   , psivec_dconr            &
     &   , phimat_dconr
!
      common /ra39/                &
     &     ampr_ampdu              &
     &   , amprlo_ampdu            &
     &   , amprhi_ampdu            &
     &   , ampr_errlo_ampdu        &
     &   , ampr_errhi_ampdu        &
     &   , psivec_ampdu            &
     &   , psibar                  &
     &   , phibar                  &
     &   , dampr1                  &
     &   , ozetabar                &
     &   , zetabar                 &
     &   , phimat_ampdu
!
      common /ra40/                &
     &     uevphi                  &
     &   , ouevphi                 &
     &   , phiuev                  &
     &   , evphi                   &
     &   , phifv1                  &
     &   , phifv2                  &
     &   , ophibar                 &
     &   , psiuev
!
      common /ra41/                &
     &     hpspecv_dconp           &
     &   , hpspecv0_dconp          &
     &   , dhpspecv_dconp          &
     &   , dhpspecv0_dconp
!
      common /ra42/                &
     &     xspec_tsxdc             &
     &   , xspec_tsxdc_th          &
     &   , xspec_tsxdc_th0         &
     &   , xspec_txdcr
!
!DRLIM190524-2244:
      common /ra43/                &
     &     rjlimd                  &
     &   , rmlimd                  &
!
     &   , ark_kstp_it             &
     &   , ark_kdrv_it             &
     &   , ark_ksto_it             &
     &   , ark_kbad_it             &
     &   , ark_koks_it             &
     &   , ark_kslo_it             &
     &   , ark_khlo_it             &
     &   , ark_lhlo_it             &
     &   , ark_lerx_it             &
!
     &   , abd_kfai_it             &
     &   , abd_krdo_it             &
     &   , abd_krin_it             &
     &   , abd_kjac_it             &
     &   , abd_kist_it
!:DRLIM190524-2244
!
!
!mp_< user mp-variables and mp-arrays
      common /mp_ra01/                                                  &
     &     theta_pk                                                     &
     &   , yspec_pk                                                     &
     &   , arkabd_pk
!>mp_
!
!
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
